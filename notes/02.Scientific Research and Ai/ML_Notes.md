## ä¸€ã€æœºå™¨å­¦ä¹ 

### 1.1 æœºå™¨å­¦ä¹ å®šä¹‰

è®¡ç®—æœºç¨‹åºä»ç»éªŒEä¸­å­¦ä¹ ï¼Œè§£å†³æŸä¸€ä»»åŠ¡Tï¼Œè¿›è¡ŒæŸä¸€æ€§èƒ½Pï¼Œé€šè¿‡Pæµ‹å®šåœ¨Tä¸Šçš„è¡¨ç°å› ç»éªŒEè€Œæé«˜

> egï¼šè·³æ£‹ç¨‹åº  
> Eï¼š ç¨‹åºè‡ªèº«ä¸‹çš„ä¸Šä¸‡ç›˜æ£‹å±€  
> Tï¼š ä¸‹è·³æ£‹  
> Pï¼š ä¸æ–°å¯¹æ‰‹ä¸‹è·³æ£‹æ—¶èµ¢çš„æ¦‚ç‡

### 1.2 ç›‘ç£å­¦ä¹  supervised learning

#### 1.2.1 ç›‘ç£å­¦ä¹ å®šä¹‰

ç»™ç®—æ³•ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«äº†æ­£ç¡®ç­”æ¡ˆï¼Œç®—æ³•çš„ç›®çš„æ˜¯ç»™å‡ºæ›´å¤šçš„æ­£ç¡®ç­”æ¡ˆ

> å¦‚é¢„æµ‹æˆ¿ä»·ï¼ˆ[å›å½’é—®é¢˜](https://so.csdn.net/so/search?q=%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98&spm=1001.2101.3001.7020)ï¼‰ã€è‚¿ç˜¤è‰¯æ€§æ¶æ€§åˆ†ç±»ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰

### 1.3 æ— ç›‘ç£å­¦ä¹  unsupervised learning

#### 1.3.1 æ— ç›‘ç£å­¦ä¹ å®šä¹‰

åªç»™ç®—æ³•ä¸€ä¸ªæ•°æ®é›†ï¼Œä½†æ˜¯**ä¸ç»™æ•°æ®é›†çš„æ­£ç¡®ç­”æ¡ˆ**ï¼Œç”±ç®—æ³•è‡ªè¡Œåˆ†ç±»ã€‚

> å¦‚èšç±»  
> 1.è°·æ­Œæ–°é—»æ¯å¤©æ”¶é›†å‡ åä¸‡æ¡æ–°é—»ï¼Œå¹¶æŒ‰ä¸»é¢˜åˆ†å¥½ç±»  
> 2.å¸‚åœºé€šè¿‡å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç±»ï¼Œç¡®å®šç›®æ ‡ç”¨æˆ·  
> 3.é¸¡å°¾é…’ç®—æ³•ï¼šä¸¤ä¸ª[éº¦å…‹é£](https://so.csdn.net/so/search?q=%E9%BA%A6%E5%85%8B%E9%A3%8E&spm=1001.2101.3001.7020)åˆ†åˆ«ç¦»ä¸¤ä¸ªäººä¸åŒè·ç¦»ï¼Œå½•åˆ¶ä¸¤æ®µå½•éŸ³ï¼Œå°†ä¸¤ä¸ªäººçš„å£°éŸ³åˆ†ç¦»å¼€æ¥ï¼ˆåªéœ€ä¸€è¡Œä»£ç å°±å¯å®ç°ï¼Œä½†å®ç°çš„è¿‡ç¨‹è¦èŠ±å¤§é‡çš„æ—¶é—´ï¼‰

#### 1.3.2 èšç±»ç®—æ³•

## äºŒã€å•å˜é‡çš„çº¿æ€§å›å½’ univariate linear regressionâ€”â€”é¢„æµ‹é—®é¢˜

### 2.1 å•å˜é‡çº¿æ€§å‡½æ•°

**å‡è®¾å‡½æ•°** h<sub>Î¸</sub>(x) = Î¸<sub>0</sub> + Î¸<sub>1</sub>x  
**ä»£ä»·å‡½æ•°** **å¹³æ–¹è¯¯å·®å‡½æ•°**æˆ–è€…**å¹³æ–¹è¯¯å·®ä»£ä»·å‡½æ•°**  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830949.png)

> h(x(i))æ˜¯é¢„æµ‹å€¼ï¼Œä¹Ÿå†™åšyå¸½ï¼Œy(i)æ˜¯å®é™…å€¼ï¼Œä¸¤è€…å–å·®  
> åˆ†æ¯çš„2æ˜¯ä¸ºäº†åç»­æ±‚åå¯¼æ›´å¥½è®¡ç®—ã€‚

**ç›®æ ‡ï¼š** æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼Œå³minimize J(Î¸0, Î¸1)

- å¾—åˆ°çš„ä»£ä»·å‡½æ•°çš„ ä¸‰ç»´å›¾å¦‚ä¸‹  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830950.png)
- å°†**ä¸‰ç»´å›¾å¹³é¢åŒ–** ç­‰é«˜çº¿å›¾ contour plot  
  ç­‰é«˜çº¿çš„ä¸­å¿ƒå¯¹åº”æœ€å°ä»£ä»·å‡½æ•°  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830951.png)
- 

### 2.2 æ¢¯åº¦ä¸‹é™ç®—æ³• Gradient Descent algorithm

**ç®—æ³•æ€è·¯**

- æŒ‡å®šÎ¸0 å’Œ Î¸1çš„åˆå§‹å€¼
- ä¸æ–­æ”¹å˜Î¸0å’ŒÎ¸1çš„å€¼ï¼Œä½¿J(Î¸0,Î¸1)ä¸æ–­å‡å°
- å¾—åˆ°ä¸€ä¸ªæœ€å°å€¼æˆ–å±€éƒ¨æœ€å°å€¼æ—¶åœæ­¢

**æ¢¯åº¦**ï¼š å‡½æ•°ä¸­æŸä¸€ç‚¹(x, y)çš„æ¢¯åº¦ä»£è¡¨å‡½æ•°åœ¨è¯¥ç‚¹**å˜åŒ–æœ€å¿«çš„æ–¹å‘**  
ï¼ˆé€‰ç”¨ä¸åŒçš„ç‚¹å¼€å§‹å¯èƒ½è¾¾åˆ°å¦ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼ï¼‰

**æ¢¯åº¦ä¸‹é™å…¬å¼**  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830952.png)

- Î¸0å’ŒÎ¸1**åº”åŒæ­¥æ›´æ–°**ï¼Œå¦åˆ™å¦‚æœå…ˆæ›´æ–°Î¸0ï¼Œä¼šä½¿å¾—Î¸1æ˜¯æ ¹æ®æ›´æ–°åçš„Î¸0å»æ›´æ–°çš„ï¼Œä¸æ­£ç¡®ç»“æœä¸ç›¸ç¬¦![*](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830953.png)

- **åŸç†**ï¼šåå¯¼è¡¨ç¤ºçš„æ˜¯**æ–œç‡**ï¼Œæ–œç‡åœ¨æœ€ä½ç‚¹å·¦è¾¹ä¸ºè´Ÿï¼Œæœ€ä½ç‚¹å³è¾¹ä¸ºæ­£ã€‚ åœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œåå¯¼å€¼ä¼šä¸æ–­å˜å°ï¼Œè¿›è€Œç§»åŠ¨çš„æ­¥å¹…ä¹Ÿä¸æ–­å˜å°ï¼Œæœ€åä¸æ–­æ”¶æ•›ç›´åˆ°åˆ°è¾¾æœ€ä½ç‚¹ï¼›åœ¨æœ€ä½ç‚¹å¤„åå¯¼å€¼ä¸º0ï¼Œä¸å†ç§»åŠ¨  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830954.png)

**å…³äºÎ±çš„é€‰æ‹©**  
å¦‚æœÎ±é€‰æ‹©å¤ªå°ï¼Œä¼šå¯¼è‡´æ¯æ¬¡ç§»åŠ¨çš„æ­¥å¹…éƒ½å¾ˆå°ï¼Œæœ€ç»ˆéœ€è¦å¾ˆå¤šæ­¥æ‰èƒ½æœ€ç»ˆæ”¶æ•›  
å¦‚æœÎ±é€‰æ‹©å¤ªå¤§ï¼Œä¼šå¯¼è‡´æ¯æ¬¡ç§»åŠ¨çš„æ­¥å¹…è¿‡å¤§ï¼Œå¯èƒ½ä¼šè¶Šè¿‡æœ€å°å€¼ï¼Œæ— æ³•æ”¶æ•›ç”šè‡³ä¼šå‘æ•£

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830955.png)

### 2.3 ç”¨äºçº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ â€”â€”Batchæ¢¯åº¦ä¸‹é™

- **å…¬å¼æ¨å¯¼**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830956.png)

- **æ¢¯åº¦å›å½’çš„å±€é™æ€§**ï¼š å¯èƒ½å¾—åˆ°çš„æ˜¯å±€éƒ¨æœ€ä¼˜è§£  
  **çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™çš„å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œbowl shape**ï¼Œå› æ­¤æ²¡æœ‰å±€éƒ¨æœ€ä¼˜è§£ï¼Œåªæœ‰å…¨å±€æœ€ä¼˜è§£  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830957.png)  
  [æ‹“å±•ï¼šå‡¸å‡½æ•°ä¸å‡¹å‡½æ•°](https://www.cnblogs.com/tgycoder/p/6164541.html)

- **æ‰¹é‡æ¢¯åº¦ä¸‹é™ ä»£ç å®ç°**  
  æ‰¹å¤„ç†æ˜¯æŒ‡**åœ¨ä¸€æ¬¡è¿­ä»£ä¸­è¿è¡Œæ‰€æœ‰çš„ä¾‹å­**  
  éªŒè¯æ¢¯åº¦ä¸‹é™æ˜¯å¦æ­£å¸¸å·¥ä½œçš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯çœ‹ä¸€ä¸‹ğ½(ğ‘¤,ğ‘)çš„å€¼ã€‚  
  å¹¶æ£€æŸ¥å®ƒæ˜¯å¦æ¯ä¸€æ­¥éƒ½åœ¨å‡å°‘

```python
def gradient_descent(x, y, w_in, b_in, cost_function, gradient_function, alpha, num_iters): 
    """
    Performs batch gradient descent to learn theta. Updates theta by taking 
    num_iters gradient steps with learning rate alpha
    
    Args:
      x :    (ndarray): Shape (m,)
      y :    (ndarray): Shape (m,)
      w_in, b_in : (scalar) Initial values of parameters of the model
      cost_function: function to compute cost
      gradient_function: function to compute the gradient
      alpha : (float) Learning rate
      num_iters : (int) number of iterations to run gradient descent
    Returns
      w : (ndarray): Shape (1,) Updated values of parameters of the model after
          running gradient descent
      b : (scalar)                Updated value of parameter of the model after
          running gradient descent
    """
    
    # number of training examples
    m = len(x)
    
    # An array to store cost J and w's at each iteration â€” primarily for graphing later
    J_history = []
    w_history = []
    w = copy.deepcopy(w_in)  #avoid modifying global w within function
    b = b_in
    
    for i in range(num_iters):

        # Calculate the gradient and update the parameters
        dj_dw, dj_db = gradient_function(x, y, w, b )  

        # Update Parameters using w, b, alpha and gradient
        w = w - alpha * dj_dw               
        b = b - alpha * dj_db               

        # Save cost J at each iteration
        if i<100000:      # prevent resource exhaustion 
            cost =  cost_function(x, y, w, b)
            J_history.append(cost)

        # Print cost every at intervals 10 times or as many iterations if < 10
        if i% math.ceil(num_iters/10) == 0:
            w_history.append(w)
            print(f"Iteration {i:4}: Cost {float(J_history[-1]):8.2f}   ")
        
    return w, b, J_history, w_history #return w and J,w history for graphing
```

## ä¸‰ã€numpyçš„å‘é‡Vectorsã€çŸ©é˜µMatrices

å‚è€ƒè¯¾åä½œä¸š C1\_W2\_Lab01\_Python\_Numpy\_Vectorization\_Soln  
or  
ç½‘ä¸Šæ•™ç¨‹

## å››ã€å¤šå…ƒçº¿æ€§å›å½’ multiple linear regression

### 4.1å¤šå˜é‡çº¿æ€§å›å½’å‡½æ•°

- å¤šå…ƒç‰¹å¾è¡¨ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830958.png)

> x<sup>(i)</sup> è¡¨ç¤ºç¬¬ i ç»„æ ·æœ¬  
> x<sub>j</sub><sup>(i)</sup> è¡¨ç¤ºç¬¬ i ç»„æ ·æœ¬ä¸­çš„ç¬¬ j ä¸ªæ•°æ®

- ç‰¹å¾å‚æ•°  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830959.png)
- å¤šå…ƒå˜é‡çº¿æ€§å›å½’æ¨¡å‹  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830960.png)

### 4.2 å¤šå…ƒæ¢¯åº¦ä¸‹é™æ³• Gradient Descent With Multiple Variables

- æŸå¤±å‡½æ•°è®¡ç®—J  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830961.png)
- è®¡ç®—æ¢¯åº¦  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830962.png)
- æ¢¯åº¦ä¸‹é™å®ç°

### 4.3 ç‰¹å¾ç¼©æ”¾ feature scaling (ä½¿å…·æœ‰ç›¸ä¼¼çš„èŒƒå›´)

- **ç›®çš„** ï¼šè®©æ¢¯åº¦ä¸‹é™è¿è¡Œçš„æ›´å¿«

- é—®é¢˜ï¼šå½“ç‰¹å¾èŒƒå›´ç›¸å·®å¤ªå¤§æ—¶ï¼Œä¼šä¸€ç›´æ¥å›æŒ¯è¡ï¼Œæ¢¯åº¦ä¸‹é™æ•ˆç‡ä½ã€‚å¦‚ä¸‹ä¾‹ä¸­ï¼Œx1èŒƒå›´ä¸º0~2000ï¼Œ x2èŒƒå›´ä¸º 1~5  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830963.png)

> åœ¨è¯¾åä½œä¸š C1\_W2\_Lab03\_Feature\_Scaling\_and\_Learning\_Rate\_Soln  
> è®©ä¸­è§£é‡Šäº†ä¸ºä»€ä¹ˆè¦é‡‡ç”¨ç‰¹å¾ç¼©æ”¾=ã€‹åœ¨æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¸­å¯¹å‚æ•°çš„æ›´æ–°å¯ä»¥ä½¿æ¯ä¸ªå‚æ•°çš„è¿›å±•ç›¸ç­‰ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830964.png)![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830965.png)  
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830966.png)

#### 4.3.1 Mean normalization å‡å€¼å½’ä¸€åŒ–

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830967.png)

#### 4.3.2 Z-score normalization Z-scoreå½’ä¸€åŒ–

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830968.png)

- **æœ€ç»ˆç¼©æ”¾èŒƒå›´**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830969.png)

> è¯¾åä½œä¸š C1\_W2\_Lab03\_Feature\_Scaling\_and\_Learning\_Rate\_Soln  
> ç¬¬ä¸€æ­¥å‘ç°ä»æ¯ä¸ªç‰¹å¾ä¸­å»é™¤å¹³å‡å€¼æˆ–å¹³å‡æ•°å€¼ã€‚è¿™å°±ç•™ä¸‹äº†ä»¥é›¶ä¸ºä¸­å¿ƒçš„ç‰¹å¾ã€‚å¾ˆéš¾çœ‹åˆ° "å¹´é¾„ "ç‰¹å¾çš„å·®å¼‚ï¼Œä½† "å°ºå¯¸ï¼ˆå¹³æ–¹è‹±å°ºï¼‰"æ˜¾ç„¶æ˜¯åœ¨é›¶é™„è¿‘ã€‚ç¬¬äºŒæ­¥æ˜¯é™¤ä»¥æ–¹å·®ã€‚è¿™ä½¿å¾—ä¸¤ä¸ªç‰¹å¾éƒ½ä»¥é›¶ä¸ºä¸­å¿ƒï¼Œå°ºåº¦ç›¸ä¼¼ã€‚![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830970.png)

### 4.4 å¦‚ä½•é€‰æ‹©å­¦ä¹ ç‡

#### 4.4.1 å­¦ä¹ æ›²çº¿ learning curve

é€šè¿‡å­¦ä¹ æ›²çº¿ï¼Œå¯ä»¥æ‰¾åˆ°ä½•æ—¶å¯ä»¥å¼€å§‹è®­ç»ƒæˆ‘çš„æ¨¡å‹ï¼Œå³å¤šå°‘æ¬¡iterationsåæ”¶æ•›  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830971.png)  
è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ï¼š**è‡ªåŠ¨æ”¶æ•›æµ‹è¯•** automatic convergence test

#### 4.4.2 å­¦ä¹ ç‡çš„é€‰æ‹©

- é—®é¢˜ï¼šå¦‚æœå­¦ä¹ ç‡å¤ªå¤§æˆ–è€…å¤ªå°çš„æƒ…å†µã€Jä»£ç å†™é”™äº†  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830972.png)
- é€‰å–åˆé€‚çš„Î±ï¼š
- â€¦ï¼Œ 0.001ï¼Œ0.003ï¼Œ0.01ï¼Œ0.03ï¼Œ0.1ï¼Œ0.3ï¼Œ1ï¼Œâ€¦  
  **ä»¥3ä¸ºå€æ•°æ‰¾åˆ°ä¸€ä¸ªæœ€å¤§å€¼ï¼Œä»¥è¯¥æœ€å¤§å€¼ æˆ–æ¯”è¯¥æœ€å¤§å€¼ç•¥å°çš„å€¼ä½œä¸ºÎ±**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830973.png)

### 4.5 ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’polynomial regression

#### 4.5.1 ç‰¹å¾å·¥ç¨‹ feature engineering

**é€šè¿‡è½¬æ¢ã€ç»“åˆè®¾è®¡æ–°çš„ç‰¹å¾x**

å‡è®¾æœ‰ä¸¤ä¸ªç‰¹å¾ï¼šx1 æ˜¯åœŸåœ°å®½åº¦ï¼Œx2 æ˜¯åœŸåœ°çºµå‘æ·±åº¦ï¼Œåˆ™æœ‰hÎ¸(x) = Î¸0 + Î¸1x1 + Î¸2x2  
ç”±äºæˆ¿ä»·å®é™…ä¸é¢ç§¯æŒ‚é’©ï¼Œæ‰€ä»¥å¯å‡è®¾x = x1 \* x2ï¼Œåˆ™æœ‰hÎ¸(x) = Î¸0 + Î¸1x  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830974.png)

#### 4.5.2 å¤šé¡¹å¼å›å½’

- é€‰ç”¨äºŒæ¬¡æ¨¡å‹æ‹Ÿåˆ  
  æ›²çº¿ååŠæ˜æ˜¾ä¸‹é™ï¼Œä¸ç¬¦åˆå®é™…  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830975.png)

- é€‰ç”¨ä¸‰æ¬¡æ¨¡å‹æ‹Ÿåˆ  
  æ›²çº¿ç¬¦åˆå®é™…ï¼Œä½†ç”±äºæ¬¡æ–¹çš„å‡ºç°ï¼Œè¦ååˆ†æ³¨æ„è‡ªå˜é‡èŒƒå›´çš„é€‰å–  
  **ç‰¹å¾è¢«é‡æ–°æ ‡å®šï¼Œç‰¹å¾ç¼©æ”¾ï¼Œè®©å®ƒä»¬å½¼æ­¤ä¹‹é—´å…·æœ‰å¯æ¯”æ€§**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830977.png)

- é€‰ç”¨æ ¹å·æ¨¡å‹  
  èƒ½å……åˆ†æ‹Ÿåˆï¼Œä¸”è‡ªå˜é‡èŒƒå›´å¯å˜æ›²åº¦å¤§  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830978.png)

## äº”ã€é€»è¾‘å›å½’logistic regressionâ€”â€”åˆ†ç±»é—®é¢˜

### 5.1 çº¿æ€§å›å½’å¯¹äºåˆ†ç±»é—®é¢˜çš„å±€é™æ€§

ç”±äº**ç¦»ç¾¤ç‚¹**çš„å­˜åœ¨ï¼Œçº¿æ€§å›å½’ä¸é€‚ç”¨äºåˆ†ç±»é—®é¢˜ã€‚  
å¦‚ä¸‹å›¾ï¼ˆé˜ˆå€¼ä¸º0.5ï¼‰ï¼Œç”±äºæœ€å³ç¦»ç¾¤ç‚¹ï¼Œå†ç”¨çº¿æ€§å›å½’ä¸å®é™…æƒ…å†µä¸æ‹Ÿåˆã€‚  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830979.png)  
å¼•å…¥ **é€»è¾‘å›å½’ï¼ˆlogistic regressionï¼‰** ç®—æ³•ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

- **é€»è¾‘å›å½’æ¨¡å‹**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830980.png)  
  **sigmoid function === logistic function**

è¯¾åä½œä¸šC1\_W3\_Lab02\_Sigmoid\_function\_Soln  
è¿™å¼ å›¾å¯ä»¥æ›´å¥½çš„å¸®ç†è§£  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830981.png)

### 5.2 å†³ç­–è¾¹ç•Œ decision boundary

- æ¨å¯¼ ä»€ä¹ˆæƒ…å†µä¸‹æ˜¯åˆ†ç•Œçº¿  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830982.png)
- eg1  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830983.png)
- eg2  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830984.png)
- eg3  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830985.png)

### 5.3 ä»£ä»·å‡½æ•° cost function

#### 5.3.1 cost functionçš„å¯¼å‡º

- é—®é¢˜  
  çº¿æ€§å›å½’çš„æŸå¤±å‡½æ•°J é‡‡ç”¨çš„æ˜¯å¹³æ–¹è¯¯å·®squared error costï¼Œåº”ç”¨åˆ°åˆ†ç±»é—®é¢˜æ—¶å€™çš„Jå›¾åƒä¸æ˜¯convextå‡¸å‡½æ•°ï¼Œæ— æ³•ç”¨æ¢¯åº¦ä¸‹é™æ‰¾åˆ°å…¨å±€æœ€å°å€¼ï¼  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830986.png)

å°†çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°æ”¹å†™ä¸ºå¦‚ä¸‹å½¢å¼ **ï¼ˆå³æŠŠ1/2æåˆ°åé¢å»ï¼‰**  
å¾—åˆ°é€»è¾‘å›å½’çš„cost function

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830987.png)  
å®šä¹‰loss function  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830988.png)

- æ³¨æ„åŒºåˆ†å®šä¹‰

> **æŸå¤±å‡½æ•° loss function**æ˜¯åœ¨**ä¸€ä¸ªè®­ç»ƒæ ·æœ¬**çš„è¡¨ç°ï¼ŒæŠŠæ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„æŸå¤±åŠ èµ·æ¥å¾—åˆ°çš„**ä»£ä»·å‡½æ•°cost function**ï¼Œæ‰èƒ½è¡¡é‡æ¨¡å‹åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„è¡¨ç°

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830989.png)

#### 5.3.2 é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830990.png)  
yè¡¨ç¤ºå®é™…ï¼ŒhÎ¸(x)è¡¨ç¤ºé¢„æµ‹  
**ï¼ˆhÎ¸(x)å°±æ˜¯è¿™é‡Œçš„f wb å› ä¸º2021è¯¾ç¨‹ç”¨çš„æ˜¯hÎ¸(x) ä¸¤ä¸ªè¯¾ç¨‹éƒ½æœ‰æ¶‰åŠï¼‰**

1. å½“çœŸæ˜¯å€¼y = 1æ—¶  
   if é¢„æµ‹hÎ¸(x) = 1, cost = 0  
   if é¢„æµ‹hÎ¸(x) = 0, cost = âˆ **ï¼ˆé¢„æµ‹ä¸å®é™…å®Œå…¨ä¸ä¸€è‡´ï¼ŒæŸå¤±å‡½æ•°å¾ˆå¤§ï¼Œé¢„æµ‹å’Œå®é™…å·®è·å¾ˆå¤§ï¼‰**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830991.png)

2. å½“çœŸå®å€¼y = 0æ—¶  
   if é¢„æµ‹hÎ¸(x) = 0, cost = 0  
   if é¢„æµ‹hÎ¸(x) = 1, cost = âˆ **ï¼ˆé¢„æµ‹ä¸å®é™…å®Œå…¨ä¸ä¸€è‡´ï¼ŒæŸå¤±å‡½æ•°å¾ˆå¤§ï¼Œé¢„æµ‹å’Œå®é™…å·®è·å¾ˆå¤§ï¼‰**  
   ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830992.png)

> æ³¨æ„ä¸€ä¸‹ f= -logï¼ˆ1-xï¼‰å›¾åƒçš„ç”»æ³•

#### 5.3.3 ç®€åŒ–ä»£ä»·å‡½æ•° ä¸ æ¢¯åº¦ä¸‹é™

æŠŠåˆ†ç±»è®¨è®ºå·§å¦™åˆ©ç”¨æ¡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå¼å­  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830993.png)  
è¿›è€Œå¾—åˆ°çš„cost function J ä¸º  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830994.png)

> åœ¨æ—§çš„è¯¾ç¨‹ä¸­æ˜¯è¿™æ ·å†™çš„ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ï¼åé¢ä¸å†èµ˜è¿°ï¼  
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830995.png)

> ä»£ä»·J æ˜¯å¹³å‡æŸå¤±ï¼Œæ˜¯åŒ…å«mä¸ªæ ·æœ¬çš„è®­ç»ƒé›†çš„å¹³å‡æŸå¤±

- æ¢¯åº¦ä¸‹é™  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830996.png)  
  **æ³¨æ„ï¼š**  
  é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™**çœ‹ä¼¼**ä¸çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç›¸åŒï¼Œä½†æœ¬è´¨ä¸åŒï¼Œå› ä¸ºä»–ä»¬çš„fxçš„åŸå‹ä¸ä¸€æ ·

[ä¼ é€é—¨ï¼šé€»è¾‘å›å½’æ¢¯åº¦ä¸‹é™å…¬å¼æ¨å¯¼](https://blog.csdn.net/Piratesa/article/details/100586729)

## å…­ã€ è¿‡æ‹Ÿåˆé—®é¢˜

### 6.1 è¿‡æ‹Ÿåˆå®šä¹‰

- **å®šä¹‰**  
  **è¿‡æ‹Ÿåˆ**  
  å½“å˜é‡è¿‡å¤šæ—¶ï¼Œè®­ç»ƒå‡ºæ¥çš„å‡è®¾èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒé›†ï¼Œæ‰€ä»¥ä»£ä»·å‡½æ•°å®é™…ä¸Šå¯èƒ½éå¸¸æ¥è¿‘äº0ï¼Œä½†å¾—åˆ°çš„æ›²çº¿ä¸ºäº†åƒæ–¹ç™¾è®¡çš„æ‹Ÿåˆæ•°æ®é›†ï¼Œå¯¼è‡´å®ƒæ— æ³•æ³›åŒ–åˆ°æ–°çš„æ ·æœ¬ä¸­ï¼Œæ— æ³•é¢„æµ‹æ–°æ ·æœ¬æ•°æ®  
  **æ³›åŒ–**  
  æŒ‡ä¸€ä¸ªå‡è®¾æ¨¡å‹åº”ç”¨åˆ°æ–°æ ·æœ¬çš„èƒ½åŠ›
- **ä¾‹å­**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830997.png)![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830998.png)
- **è§£å†³è¿‡æ‹Ÿåˆæ–¹æ³•**
  1. å¾—åˆ°æ›´å¤šçš„æ•°æ®
  2. ç‰¹å¾é€‰æ‹©â€”â€”é€‰ç”¨ç‰¹å¾çš„ä¸€éƒ¨åˆ†
  3. æ­£åˆ™åŒ–â€”â€”å‡å°‘å‚æ•°å¤§å°

### 6.2 è¿‡æ‹Ÿåˆçš„ä»£ä»·å‡½æ•°ï¼ˆæ­£åˆ™åŒ–åŸç†ï¼‰

- æˆ¿ä»·é¢„æµ‹å¼•å…¥  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830999.png)  
  ä»¥å·¦å›¾ä¸ºä¾‹ï¼Œå…¶ä»£ä»·å‡½æ•°ä¸º  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830000.png)  
  åœ¨ä¹‹åå†åŠ ä¸Šä¸¤é¡¹ï¼ˆ1000ä¸ºä»»æ„ä¸€ä¸ªè¾ƒå¤§çš„æ•°ï¼‰

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830001.png)

ä¸ºäº†æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼Œè‡ªç„¶è€Œç„¶åœ°Î¸3ï¼ŒÎ¸4è¦ç­‰äº0ï¼Œä»è€Œå»é™¤äº†è¿™ä¸¤é¡¹ï¼Œç›¸å½“äºæƒ©ç½šè¿™ä¸¤é¡¹ä½¿å¾—åŸæ¥çš„å¼å­å˜ä¸ºäºŒæ¬¡å‡½æ•°  
**åœ¨ä¸€èˆ¬çš„å›å½’å‡½æ•°ä¸­ï¼Œä½¿å‚æ•°çš„å€¼æ›´å°ä¸€èˆ¬ä¼šä½¿å¾—æ›²çº¿æ›´ä¸ºå¹³æ»‘è€Œå‡å°‘è¿‡æ‹Ÿåˆæƒ…å†µçš„å‘ç”Ÿ**

- **å¼•å…¥æ­£åˆ™åŒ–é¡¹ çš„ä»£ä»·å‡½æ•°**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830002.png)
  1. å¦‚æœæœ‰å¾ˆå¤šå‚æ•°ï¼Œæˆ‘ä»¬**ä¸æ¸…æ¥šå“ªä¸ªå‚æ•°æ˜¯é«˜é˜¶é¡¹**ï¼Œå³**ä¸çŸ¥é“æƒ©ç½šå“ªä¸ªèƒ½è·å¾—æ›´å¥½æ‹Ÿåˆçš„ç»“æœ**ï¼Œå› æ­¤**å¼•å…¥æ­£åˆ™åŒ–é¡¹ç»Ÿä¸€æƒ©ç½šå‚æ•°**ä»¥å¾—åˆ°è¾ƒä¸ºç®€å•çš„å‡½æ•°
  2. ç»Ÿä¸€æƒ©ç½šèƒ½å¾—åˆ°ç®€å•ç»“æœæ˜¯å› ä¸ºï¼Œé«˜é˜¶é¡¹å—åˆ°æƒ©ç½šçš„æ•ˆæœä¼šæ›´å¼ºï¼Œåæ˜ åœ¨å›¾åƒä¸Šå°±æ˜¯ä½¿å…¶å½±å“å˜å¼±
  3. å…¶ä¸­  
     .+ åçš„ä¸€é¡¹ä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œ  
     Î» ä¸º**æ­£åˆ™åŒ–å‚æ•°**ï¼Œä½œç”¨æ˜¯æ§åˆ¶ä¸¤ä¸ªä¸åŒç›®æ ‡ä¹‹é—´çš„å–èˆ  
     ï¼ˆ1ï¼‰ç¬¬ä¸€ä¸ªç›®æ ‡ä¸ç¬¬ä¸€é¡¹æœ‰å…³ï¼Œå³æˆ‘ä»¬æƒ³è¦æ›´åŠ æ‹Ÿåˆæ•°æ®é›† fit dataï¼  
     ï¼ˆ2ï¼‰ç¬¬äºŒä¸ªç›®æ ‡ä¸ç¬¬äºŒé¡¹æœ‰å…³ï¼Œå³æˆ‘ä»¬æƒ³è¦å‚æ•°Î¸jå°½é‡å° keep Î¸j samll
  4. æƒ©ç½šä»Î¸1åˆ°Î¸nï¼Œä¸åŒ…æ‹¬Î¸0(ä¹Ÿå°±æ˜¯æ–°ç‰ˆçš„b)ï¼ˆä¹‹æ‰€ä»¥**ä¸æƒ©ç½šÎ¸0æ˜¯ä¸ºäº†è®©æ‹Ÿåˆçš„å‡½æ•°å°½é‡ç®€å•**ï¼Œ**æç«¯æƒ…å†µå°±æ˜¯hÎ¸(x) = Î¸0ï¼Œä»£è¡¨çš„ä¸€æ¡æ°´å¹³çº¿ï¼Œä¸è¿‡å®æ“ä¸­æœ‰æ— Î¸0å½±å“ä¸å¤§**ï¼‰
  5. è‹¥ **Î» è®¾ç½®çš„è¿‡å¤§**ï¼Œå³å¯¹Î¸1Î¸2Î¸3Î¸4çš„æƒ©ç½šç¨‹åº¦è¿‡å¤§ï¼Œå¯¼è‡´Î¸1Î¸2Î¸3Î¸4éƒ½æ¥è¿‘äº0ï¼Œæœ€åå‡è®¾æ¨¡å‹åªå‰©ä¸€ä¸ªÎ¸0ï¼Œå‡ºç°æ¬ æ‹Ÿåˆæƒ…å†µ

åŸç†å¦‚ä¸‹å›¾

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830003.png)

> æ·»åŠ æ­£åˆ™åŒ–é¡¹åï¼Œä»£ä»·å‡½æ•°å¯¹è¯¥æƒé‡çš„åå¯¼å˜å¤§ï¼Œå³dJ/dwå˜å¤§ã€‚æ‰€ä»¥wæ›´æ–°æ—¶ï¼Œå³w:=w-a(dJ/dw)æ—¶ï¼Œwä¼šå˜å¾—æ›´å°  
> å› ä¸ºè¦æŸå¤±å‡½æ•°å°½é‡å°ï¼Œä¹Ÿå°±æ˜¯Jå°½é‡å°ã€‚å½“lamadaå¾ˆå¤§æ—¶ï¼Œwåªèƒ½å°è¶‹è¿‘äº0

### 6.3 ç”¨äºçº¿æ€§å›å½’çš„æ­£åˆ™æ–¹æ³• Regularized Linear Regression

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830004.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830005.png)

> å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¯¹bï¼ˆÎ¸0ï¼‰æ­£åˆ™åŒ–ï¼Œæ²¡æœ‰è¯•å›¾å»ç¼©å°bï¼Œå› æ­¤æ±‚åå¯¼æ²¡æœ‰å½±å“

> æ›´æ–°å…¬å¼çš„æ•°å­¦æ¨å¯¼  
> å±•å¼€ ï¼Œæé¡¹![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830006.png) æ­£åˆ™åŒ–å°±æ˜¯åœ¨æ¯ä¸€æ¬¡æ‰§è¡Œgdè¿­ä»£åï¼Œä¼šç”¨ä¸€ä¸ªç•¥å¾®å°äº1çš„æ•°ä¹˜ä»¥wj æ‰§è¡Œæ›´æ–°ï¼Œè®©wjçš„å€¼å˜å°äº†ä¸€ç‚¹ï¼Œè¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–å¯ä»¥åœ¨æ¯æ¬¡è¿­ä»£ä¸­shrink ç¼©å°wjçš„å€¼

- ä»£ç å®ç°

```python
def compute_cost_linear_reg(X, y, w, b, lambda_ = 1):
    """
    Computes the cost over all examples
    Args:
      X (ndarray (m,n): Data, m examples with n features
      y (ndarray (m,)): target values
      w (ndarray (n,)): model parameters  
      b (scalar)      : model parameter
      lambda_ (scalar): Controls amount of regularization
    Returns:
      total_cost (scalar):  cost 
    """

    m  = X.shape[0]
    n  = len(w)
    cost = 0.
    for i in range(m):
        f_wb_i = np.dot(X[i], w) + b                                   #(n,)(n,)=scalar, see np.dot
        cost = cost + (f_wb_i - y[i])**2                               #scalar             
    cost = cost / (2 * m)                                              #scalar  
 
    reg_cost = 0
    for j in range(n):
        reg_cost += (w[j]**2)                                          #scalar
    reg_cost = (lambda_/(2*m)) * reg_cost                              #scalar
    
    total_cost = cost + reg_cost                                       #scalar
    return total_cost                                                  #scalar
```

### 6.4 ç”¨äºçº¿æ€§å›å½’çš„æ­£åˆ™æ–¹æ³• Regularized Linear Regression

å½“ä½¿ç”¨å¾ˆå¤šç‰¹å¾è®­ç»ƒé€»è¾‘å›å½’æ—¶ï¼Œå¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œå¦‚ä¸‹å›¾![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830007.png)  
åœ¨gdæ—¶ï¼Œæ›´æ–°å‚æ•°å’Œçº¿æ€§å›å½’ç±»ä¼¼ï¼Œåªä¸è¿‡è¿™é‡Œçš„fæ˜¯sigmoidçš„logisticå‡½æ•°

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830008.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830009.png)

- é€»è¾‘å›å½’æ­£åˆ™åŒ–æŸå¤±å‡½æ•° ä»£ç å®ç°

```python
def compute_cost_logistic_reg(X, y, w, b, lambda_ = 1):
    """
    Computes the cost over all examples
    Args:
    Args:
      X (ndarray (m,n): Data, m examples with n features
      y (ndarray (m,)): target values
      w (ndarray (n,)): model parameters  
      b (scalar)      : model parameter
      lambda_ (scalar): Controls amount of regulariza
    Returns:
      total_cost (scalar):  cost 
    """

    m,n  = X.shape
    cost = 0.
    for i in range(m):
        z_i = np.dot(X[i], w) + b                                      #(n,)(n,)=scalar, see np.dot
        f_wb_i = sigmoid(z_i)                                          #scalar
        cost +=  -y[i]*np.log(f_wb_i) - (1-y[i])*np.log(1-f_wb_i)      #scalar
             
    cost = cost/m                                                      #scalar

    reg_cost = 0
    for j in range(n):
        reg_cost += (w[j]**2)                                          #scalar
    reg_cost = (lambda_/(2*m)) * reg_cost                              #scalar
    
    total_cost = cost + reg_cost                                       #scalar
    return total_cost                                                  #scalar
```

- ç”¨æ­£åˆ™åŒ–è®¡ç®—æ¢¯åº¦ ä»£ç   
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830010.png)

```python
 """ çº¿æ€§å›å½’ """
def compute_gradient_linear_reg(X, y, w, b, lambda_): 
    """
    Computes the gradient for linear regression 
    Args:
      X (ndarray (m,n): Data, m examples with n features
      y (ndarray (m,)): target values
      w (ndarray (n,)): model parameters  
      b (scalar)      : model parameter
      lambda_ (scalar): Controls amount of regularization
      
    Returns:
      dj_dw (ndarray (n,)): The gradient of the cost w.r.t. the parameters w. 
      dj_db (scalar):       The gradient of the cost w.r.t. the parameter b. 
    """
    m,n = X.shape           #(number of examples, number of features)
    dj_dw = np.zeros((n,))
    dj_db = 0.

    for i in range(m):                             
        err = (np.dot(X[i], w) + b) - y[i]                 
        for j in range(n):                         
            dj_dw[j] = dj_dw[j] + err * X[i, j]               
        dj_db = dj_db + err                        
    dj_dw = dj_dw / m                                
    dj_db = dj_db / m   
    
    for j in range(n):
        dj_dw[j] = dj_dw[j] + (lambda_/m) * w[j]

    return dj_db, dj_dw

 """é€»è¾‘å›å½’"""
 def compute_gradient_logistic_reg(X, y, w, b, lambda_): 
     ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
    for i in range(m):
        f_wb_i = sigmoid(np.dot(X[i],w) + b)          #(n,)(n,)=scalar
    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚

    return dj_db, dj_dw  



```

## ä¸ƒã€ç¥ç»ç½‘ç»œ(æ·±åº¦å­¦ä¹ ç®—æ³•)

### 7.1 è®¤è¯†ç¥ç»ç½‘ç»œ

- å¿…è¦æ€§  
  å½“ç‰¹å¾å€¼åªæœ‰ä¸¤ä¸ªæ—¶ï¼Œæˆ‘ä»¬ä»å¯ä»¥ç”¨ä¹‹å‰å­¦è¿‡çš„ç®—æ³•å»è§£å†³  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830011.png)  
  ä½†å½“ç‰¹å¾å€¼å¾ˆå¤šï¼Œä¸”å«æœ‰å¾ˆå¤šä¸ªå¤šæ¬¡å¤šé¡¹å¼æ—¶ï¼Œç”¨ä¹‹å‰çš„ç®—æ³•å°±å¾ˆéš¾è§£å†³äº†  
  ä¾‹å­ ï¼šå›¾åƒæ„ŸçŸ¥ Recogonition image  
  è®¡ç®—æœºè¯†åˆ«æ±½è½¦æ˜¯é åƒç´ ç‚¹çš„äº®åº¦å€¼  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830012.png)  
  ç»™å®šæ•°æ®é›†æ±½è½¦å’Œéæ±½è½¦çš„æ•°æ®ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•åˆ’åˆ†  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830013.png)  
  å¯ä»¥çœ‹åˆ°ä»…é’ˆå¯¹50\*50åƒç´ çš„ç°ç™½å›¾ç‰‡ï¼Œå°±æœ‰2500ä¸ªç‰¹å¾å€¼ï¼ˆä½œä¸ºä¸€ä¸ªç‰¹å¾å‘é‡input ï¼‰ã€‚å½“å¼•å…¥rgbæ—¶ï¼Œç‰¹å¾å€¼è¾¾åˆ°äº†7500ä¸ªï¼Œå¦‚æœç®—ä¸Šå¤šæ¬¡å¤šé¡¹å¼ï¼Œç‰¹å¾å€¼è¾¾åˆ°äº†ä¸‰ç™¾ä¸‡ä¸ªï¼Œæ˜¾ç„¶å†ç»§ç»­ç”¨ä¹‹å‰çš„ç®—æ³•éš¾ä»¥å¤„ç†è¿™ä¹ˆåºå¤§çš„æ•°æ®  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830014.png)  
  è€Œç¥ç»ç½‘ç»œåšæ³•  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830015.png)

### 7.2 å¦‚ä½•åœ¨ç¥ç»ç½‘ç»œä¸Šæ¨ç†

#### 7.2.1 ç¥ç»ç½‘ç»œçš„å®šä¹‰

å®šä¹‰ä¸€ä¸ªç¥ç»ç½‘ç»œå¦‚ä¸‹ï¼š  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830016.png)

è®¡ç®—ç¬¬lå±‚ç¬¬jä¸ªæ¿€æ´»å€¼çš„å…¬å¼  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830017.png)

> æ³¨æ„ç¬¦å·çš„å«ä¹‰ w2\_1 ä¸Šæ ‡2ä»£è¡¨layer 2 ä¸‹æ ‡ 1ä»£è¡¨ç¬¬ä¸€ä¸ªç¥ç»å…ƒ

#### 7.2.2 æ„å»ºï¼šå‰å‘ä¼ æ’­ forward propagation ï¼ˆä½¿ç”¨TensorFlowå®ç°ï¼‰

https://blog.csdn.net/weixin\_42301220/article/details/123915977

- ä¾‹å­ ï¼š æ‰‹å†™è¯†åˆ«01  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830018.png)  
  æ¯æ¬¡å±‚è®¡ç®—ï¼Œ ä»å·¦å¾€å³è®¡ç®—ï¼Œè¦ä¼ æ’­ç¥ç»å…ƒçš„æ¿€æ´»å€¼  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830019.png)

- ä¾‹å­ ï¼šçƒ¤å’–å•¡çš„å¥½å  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830020.png)

- pythonå®ç°å‰å‘ä¼ æ’­ ç†è§£  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830021.png)

> è‡ªå®šä¹‰denseå¯†é›†å‡½æ•°ï¼šè¾“å…¥å‰ä¸€å±‚çš„æ¿€æ´»ï¼Œç»™å®šå½“å‰å±‚çš„å‚æ•°ï¼Œå®ƒä¼šè¾“å‡ºä¸‹ä¸€å±‚æ¿€æ´»å€¼ è‡ªå®šä¹‰sequentialå‡½æ•°  
> å…¶ä¸­ï¼šWå¤§å†™åœ¨çº¿æ€§ä»£æ•°ä¸­ä»£è¡¨çŸ©é˜µ

- TensorFlow å®ç°å‰å‘ä¼ æ’­

- æ‹“å±•ï¼š AGI é€šç”¨äººå·¥æ™ºèƒ½  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830022.png)

#### 7.2.3 çŸ¢é‡åŒ–ï¼ˆè®©ç¥ç»ç½‘ç»œè¿è¡Œæ›´å¿«ï¼‰

- ä¸Šé¢pythonä»£ç å®ç°å‰å‘ä¼ æ’­ å¯ä»¥ç”¨æ›´ç®€æ´çš„**å‘é‡åŒ–**  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830023.png)

#### 7.2.4 çŸ©é˜µä¹˜æ³•

- å‘é‡ç‚¹ç§¯dot products  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830024.png)
- çŸ©é˜µä¹˜æ³•  
  çŸ©é˜µå°± çœ‹åš ä¸€ä¸ªä¸ª åˆ—å‘é‡ ç»„æˆçš„

> è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆçŸ©é˜µä¹˜æ³•å½¢çŠ¶è¦é‚»æ¥ç›¸åŒ 1_2 2_3 ï¼Œå› ä¸ºé•¿åº¦ç›¸åŒçš„å‘é‡æ‰èƒ½dot productï¼ï¼ï¼

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830025.png)

- ä»£ç ç†è§£ï¼Œä¸ºä»€ä¹ˆTensorFlowå¯ä»¥

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830026.png)  
**TensorFlow é»˜è®¤æ ·æœ¬æ˜¯è¡Œå‘é‡ï¼Œè€Œéåˆ—å‘é‡ï¼Œå› æ­¤ä¸éœ€è¦è½¬ç½®ç›´æ¥å†™ä½œAï¼Œè€ŒéAT**

> è¾“å…¥çš„ä¸€ä¸ªè¡Œå‘é‡åŒ…å«æ‰€æœ‰ç‰¹å¾ï¼Œå…¶ä¸­æ¯ä¸€åˆ—æ˜¯ä¸€ä¸ªç‰¹å¾![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830027.png)

#### 7.2.5 C2\_W1\_Assignment 01è¯†åˆ«

æ¯ä¸€å±‚å‚æ•°çŸ©é˜µå½¢çŠ¶çš„åˆ†æ  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830028.png)  
Tensorflowæ¨¡å‹æ˜¯é€å±‚å»ºç«‹çš„ã€‚ä½ æŒ‡å®šä¸€ä¸ªå±‚çš„è¾“å‡ºå°ºå¯¸ï¼Œè¿™å†³å®šäº†ä¸‹ä¸€å±‚çš„è¾“å…¥å°ºå¯¸ã€‚  
**æ³¨æ„ï¼šä¹Ÿå¯ä»¥æ·»åŠ ä¸€ä¸ªè¾“å…¥å±‚ï¼ŒæŒ‡å®šç¬¬ä¸€å±‚çš„è¾“å…¥ç»´åº¦ã€‚ä¾‹å¦‚ã€‚ tf.keras.Input(shape=(400,)), #æŒ‡å®šè¾“å…¥å½¢çŠ¶**

- æ„å»ºç¥ç»ç½‘ç»œ

```python
# UNQ_C1
# GRADED CELL: Sequential model

model = Sequential(
    [               
        tf.keras.Input(shape=(400,)),    #specify input size
        ### START CODE HERE ### 
        Dense(25, activation='sigmoid'), 
        Dense(15, activation='sigmoid'), 
        Dense(1,  activation='sigmoid')  
        
        ### END CODE HERE ### 
    ], name = "my_model" 
)                            

```

### 7.4 è®­ç»ƒç¥ç»ç½‘ç»œ

#### 7.4.1 æ¨¡å‹è®­ç»ƒç»†èŠ‚

eg å¯¹äº01æ‰‹å†™åˆ†ç±»é—®é¢˜  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830029.png)  
å¯¹äºé€»è¾‘å›å½’ äºŒåˆ†ç±»é—®é¢˜ç”¨Binary Cross EntropyäºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830030.png)

> ä½¿ç”¨äºŒå…ƒäº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä»¥ä¸‹å…¬å¼æ¥è®¡ç®—**å•ä¸ªæ ·æœ¬**çš„æŸå¤±ï¼š  
> l o s s = âˆ’ \[ y l o g ( p ) + ( 1 âˆ’ y ) l o g ( 1 âˆ’ p ) \] loss = -\[ylog(p) + (1-y)log(1-p)\] loss\=âˆ’\[ylog(p)+(1âˆ’y)log(1âˆ’p)\]  
> å…¶ä¸­ï¼Œ y y yæ˜¯çœŸå®æ ‡ç­¾ï¼ˆ0æˆ–1ï¼‰ï¼Œ p p pæ˜¯é¢„æµ‹å€¼ï¼ˆ0åˆ°1ä¹‹é—´çš„æ¦‚ç‡å€¼ï¼‰ã€‚è¿™ä¸ªå…¬å¼è¡¨ç¤ºï¼Œå½“çœŸå®æ ‡ç­¾ä¸º1æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é¢„æµ‹å€¼ p p pè¶Šæ¥è¿‘1ï¼Œæ­¤æ—¶æŸå¤±è¶Šå°ï¼Œç­‰äº âˆ’ l o g ( p ) -log(p) âˆ’log(p)ï¼›  
> å½“çœŸå®æ ‡ç­¾ä¸º0æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é¢„æµ‹å€¼ p p pè¶Šæ¥è¿‘0ï¼Œæ­¤æ—¶æŸå¤±ä¹Ÿè¶Šå°ï¼Œç­‰äº âˆ’ l o g ( 1 âˆ’ p ) -log(1-p) âˆ’log(1âˆ’p)ã€‚  
> https://blog.csdn.net/Cy\_coding/article/details/116427968

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830031.png)

#### 7.4.2 å¦‚ä½•é€‰æ‹©æ¿€æ´»å‡½æ•°

- ReLUæ¿€æ´»å‡½æ•°  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830032.png)

- å¯¹äºè¾“å‡ºå±‚æ¿€æ´»å‡½æ•°çš„é€‰æ‹©  
  æ ¹æ®è¾“å‡ºçš„yçš„å–å€¼èŒƒå›´  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830033.png)
- hidden layer éšè—å±‚  
  é™¤éæ˜¯äºŒåˆ†ç±»é—®é¢˜ç”¨sigmoidï¼Œä¸€èˆ¬é»˜è®¤ç”¨reluï¼Œ**ä¸èƒ½ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°**ï¼Œå¦åˆ™ä¸èƒ½æ‹Ÿåˆï¼Œå°±ç›¸å½“äºä¸€ä¸ªçº¿æ€§å›å½’äº†  
  å› ä¸º
  1. reluè®¡ç®—å¾ˆå¿«ï¼Œ
  2. å¹¶ä¸”åªæœ‰å³è¾¹æ‰å¹³flatï¼Œè€Œsigmoidæœ‰ä¸¤å¤„flatï¼Œä¼šå½±å“gdçš„é€Ÿåº¦ï¼ˆå› ä¸ºæ¿€æ´»å‡½æ•°æ˜¯è®¡ç®—åå¯¼çš„ä¸€éƒ¨åˆ†ï¼‰

> å½“æ¿€æ´»å‡½æ•°å¹³çš„åœ°æ–¹è¶Šå¤šï¼Œåœ¨æ¢¯åº¦ä¸‹é™çš„æ—¶å€™é€Ÿåº¦è¶Šæ…¢ï¼Œå› ä¸ºæ±‚å¯¼æ˜¯æ±‚æ–œç‡ï¼Œ**å¹³çš„æ–œç‡å°±å¾ˆå°å¾ˆå°**ï¼Œå› æ­¤sigmoidé€Ÿåº¦æ…¢äºRULu

### 7.5 å¤šåˆ†ç±»é—®é¢˜

#### 7.5.1 softmax å›å½’ç®—æ³•

- ä»¥ä¸‹æ¥è‡ªChatGPT

Softmax å›å½’ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯å°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°å¤šä¸ªç±»åˆ«ä¹‹ä¸€ï¼Œå¹¶ä¸º**æ¯ä¸ªç±»åˆ«åˆ†é…ä¸€ä¸ªæ¦‚ç‡**ã€‚ç®—æ³•çš„è¾“å…¥æ˜¯ä¸€ä¸ª **n n n ç»´ç‰¹å¾å‘é‡ x x x**ï¼Œè¾“å‡ºæ˜¯ K K K ä¸ªç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå…¶ä¸­ **K K K æ˜¯ç±»åˆ«çš„æ•°é‡**ã€‚

Softmax å›å½’ç®—æ³•çš„æ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š

P ( y = k âˆ£ x , W ) = exp â¡ ( w k T x ) âˆ‘ j = 1 K exp â¡ ( w j T x ) P(y=k|x,W) = \\frac{\\exp(w\_k^Tx)}{\\sum\_{j=1}^K \\exp(w\_j^Tx)} P(y\=kâˆ£x,W)\=âˆ‘j\=1Kexp(wjTx)exp(wkTx)

å…¶ä¸­ï¼Œ P ( y = k âˆ£ x , W ) P(y=k|x,W) P(y\=kâˆ£x,W) è¡¨ç¤ºç»™å®šè¾“å…¥ x x x æ—¶ï¼Œæ¨¡å‹é¢„æµ‹ y = k y=k y\=k çš„æ¦‚ç‡ï¼› **w k w\_k wk æ˜¯ä¸€ä¸ª n n n ç»´å‘é‡ï¼Œè¡¨ç¤ºç¬¬ k k k ä¸ªç±»åˆ«çš„å‚æ•°**ï¼› W W W æ˜¯ä¸€ä¸ª n Ã— K n\\times K nÃ—K çš„**å‚æ•°çŸ©é˜µï¼Œå…¶ä¸­æ¯ä¸€åˆ—å¯¹åº”ä¸€ä¸ªç±»åˆ«çš„å‚æ•°ã€‚**

---

æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰

å¯¹äºä¸€ä¸ª**å•ç‹¬çš„æ ·æœ¬ ( x , y ) (x, y) (x,y)**ï¼Œå…¶ä¸­ **x x x æ˜¯è¾“å…¥ç‰¹å¾ï¼Œ y y y æ˜¯è¾“å‡ºç±»åˆ«**ï¼Œå‡è®¾ Softmax å›å½’æ¨¡å‹çš„è¾“å‡ºä¸º P ( y = k âˆ£ x , W ) P(y=k|x,W) P(y\=kâˆ£x,W)ï¼Œå³è¾“å…¥ x x x åœ¨ç»™å®šå‚æ•° W W W ä¸‹å±äºç±»åˆ« k k k çš„æ¦‚ç‡ï¼Œåˆ™è¯¥æ ·æœ¬çš„äº¤å‰ç†µæŸå¤±å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š

L ( W ; x , y ) = âˆ’ âˆ‘ k = 1 K y k log â¡ P ( y = k âˆ£ x , W ) L(W; x, y) = - \\sum\_{k=1}^K y\_k \\log P(y=k|x,W) L(W;x,y)\=âˆ’k\=1âˆ‘KyklogP(y\=kâˆ£x,W)

å…¶ä¸­ï¼Œ **y k y\_k yk è¡¨ç¤ºçœŸå®æ ‡ç­¾çš„ one-hot ç¼–ç å½¢å¼**ï¼Œ K K K æ˜¯ç±»åˆ«æ€»æ•°ã€‚

æŸå¤±å‡½æ•°çš„æ„ä¹‰æ˜¯è¡¨ç¤ºæ¨¡å‹å¯¹äºè¯¥æ ·æœ¬çš„é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®è·ï¼Œå½“æ¨¡å‹å¯¹äºæ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡è¶Šæ¥è¿‘çœŸå®æ ‡ç­¾æ—¶ï¼ŒæŸå¤±å‡½æ•°è¶Šå°ï¼Œæ¨¡å‹çš„åˆ†ç±»å‡†ç¡®åº¦è¶Šé«˜ã€‚ï¼ˆå¯ä»¥ç”»å›¾åˆ†æï¼‰

---

åœ¨ Softmax å›å½’ç®—æ³•ä¸­ï¼Œé€šå¸¸ä½¿ç”¨äº¤å‰ç†µï¼ˆCross-entropyï¼‰ä½œä¸º**ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰ã€‚**

å¯¹äºä¸€ä¸ª**è®­ç»ƒé›†** D = ( x i , y i ) i = 1 m D={(x\_i,y\_i)}\_{i=1}^m D\=(xi,yi)i\=1m ï¼Œå…¶ä¸­ **x i x\_i xi æ˜¯ç¬¬ i i i ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œ y i y\_i yi æ˜¯ç¬¬ i i i ä¸ªæ ·æœ¬çš„ç±»åˆ«**ï¼Œå…¶å–å€¼ä¸º 1 , 2 , â€¦ , K 1, 2, \\ldots, K 1,2,â€¦,K ä¸­çš„ä¸€ä¸ªã€‚æ¨¡å‹çš„å‚æ•°ä¸º W W Wã€‚åˆ™ **Softmax å›å½’æ¨¡å‹çš„äº¤å‰ç†µä»£ä»·å‡½æ•°**å¯ä»¥è¡¨ç¤ºä¸ºï¼š

J ( W ) = âˆ’ 1 m âˆ‘ i = 1 m âˆ‘ k = 1 K y i , k log â¡ exp â¡ ( w k T x i ) âˆ‘ j = 1 K exp â¡ ( w j T x i ) J(W)=-\\frac{1}{m}\\sum\_{i=1}^m \\sum\_{k=1}^K y\_{i,k}\\log\\frac{\\exp(w\_k^Tx\_i)}{\\sum\_{j=1}^K \\exp(w\_j^Tx\_i)} J(W)\=âˆ’m1i\=1âˆ‘mk\=1âˆ‘Kyi,klogâˆ‘j\=1Kexp(wjTxi)exp(wkTxi)

å…¶ä¸­ **y i , k y\_{i,k} yi,k æ˜¯ä¸€ä¸ª K ç»´å‘é‡ï¼Œè¡¨ç¤ºç¬¬ i i i ä¸ªæ ·æœ¬çš„å®é™…è¾“å‡º**ï¼Œå¯¹åº”äºç¬¬ k k k ä¸ªç±»åˆ«ï¼Œåªæœ‰ä¸€ä¸ªå…ƒç´ ä¸º 1 1 1ï¼Œå…¶ä½™ä¸º 0 0 0ã€‚

è¿™ä¸ªä»£**ä»·å‡½æ•°çš„å«ä¹‰æ˜¯å¯¹äºæ‰€æœ‰çš„æ ·æœ¬ï¼Œæ±‚é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®è·**ï¼Œå¹¶å¯¹è¿™ä¸ªå·®è·å–å¹³å‡ã€‚

---

è®­ç»ƒ Softmax å›å½’æ¨¡å‹é€šå¸¸ä½¿ç”¨**æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ–¹æ³•**ã€‚ç»™å®šä¸€ä¸ªè®­ç»ƒé›† D = ( x i , y i ) i = 1 m D={(x\_i,y\_i)}\_{i=1}^m D\=(xi,yi)i\=1mï¼Œå…¶ä¸­ x i x\_i xi æ˜¯ç¬¬ i i i ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œ y i y\_i yi æ˜¯ç¬¬ i i i ä¸ªæ ·æœ¬çš„ç±»åˆ«ï¼Œ**æ¨¡å‹çš„å‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§åŒ–è®­ç»ƒé›†çš„ä¼¼ç„¶å‡½æ•°å¾—åˆ°ï¼š**

arg â¡ max â¡ W âˆ i = 1 m P ( y i âˆ£ x i , W ) \\arg\\max\_W \\prod\_{i=1}^m P(y\_i|x\_i,W) argWmaxi\=1âˆmP(yiâˆ£xi,W)

è¿™ä¸ªæœ€å¤§åŒ–é—®é¢˜é€šå¸¸å¯ä»¥é€šè¿‡**æ¢¯åº¦ä¸‹é™**ç­‰ä¼˜åŒ–æ–¹æ³•æ±‚è§£ã€‚

---

åœ¨ Softmax å›å½’ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è®­ç»ƒæ•°æ®æ¥è·å¾—æ¨¡å‹çš„å‚æ•°ï¼Œé€šå¸¸ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descentï¼ŒSGDï¼‰ç­‰ä¼˜åŒ–ç®—æ³•æ¥æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œä»è€Œè·å¾—æ¨¡å‹çš„å‚æ•°ã€‚

å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†è®­ç»ƒé›†åˆ†æˆå°æ‰¹é‡æ•°æ®ï¼Œæ¯ä¸ªå°æ‰¹é‡æ•°æ®åŒ…å« n n n ä¸ªæ ·æœ¬ã€‚å¯¹äºæ¯ä¸ªå°æ‰¹é‡æ•°æ®ï¼Œè®¡ç®—å…¶å¹³å‡æŸå¤±ï¼Œå¹¶è®¡ç®—æŸå¤±å‡½æ•°å¯¹äºæ¨¡å‹å‚æ•°çš„æ¢¯åº¦ã€‚ç„¶åï¼Œæ ¹æ®è®¡ç®—å‡ºçš„æ¢¯åº¦æ›´æ–°æ¨¡å‹çš„å‚æ•°ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ï¼ˆä¾‹å¦‚è¾¾åˆ°æŒ‡å®šçš„è¿­ä»£æ¬¡æ•°æˆ–è€…æŸå¤±å‡½æ•°å·²ç»æ”¶æ•›ï¼‰ã€‚

å¯¹äº **Softmax å›å½’ç®—æ³•ï¼Œç”±äºé‡‡ç”¨äº†äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡æ¢¯åº¦ä¸‹é™æ¥æœ€å°åŒ–æŸå¤±å‡½æ•°**ï¼ˆå‡¸å‡½æ•°ï¼Œå› æ­¤ä¸å­˜åœ¨å±€éƒ¨æœ€å°å€¼ã€‚è¿™æ„å‘³ç€æ¢¯åº¦ä¸‹é™ç­‰ä¼˜åŒ–ç®—æ³•å¯ä»¥åœ¨æœ‰é™æ¬¡è¿­ä»£åæ‰¾åˆ°å…¨å±€æœ€å°å€¼ï¼‰ï¼Œä»è€Œè·å¾—æ¨¡å‹çš„å‚æ•°ã€‚å…·ä½“æ¥è¯´ï¼Œæ¨¡å‹å‚æ•°çš„æ›´æ–°å…¬å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š

W â† W âˆ’ Î· âˆ‚ L ( W ; x i , y i ) âˆ‚ W W \\leftarrow W - \\eta \\frac{\\partial L(W;x\_i, y\_i)}{\\partial W} Wâ†Wâˆ’Î·âˆ‚Wâˆ‚L(W;xi,yi)

å…¶ä¸­ W W W è¡¨ç¤ºæ¨¡å‹å‚æ•°ï¼Œ Î· \\eta Î· æ˜¯å­¦ä¹ ç‡ï¼Œ âˆ‚ L ( W ; x i , y i ) âˆ‚ W \\frac{\\partial L(W;x\_i, y\_i)}{\\partial W} âˆ‚Wâˆ‚L(W;xi,yi) è¡¨ç¤ºæŸå¤±å‡½æ•°å¯¹äºæ¨¡å‹å‚æ•°çš„æ¢¯åº¦ã€‚

åœ¨**å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œä¾‹å¦‚å½’ä¸€åŒ–ã€æ ‡å‡†åŒ–ç­‰ï¼Œä»¥åŠæ·»åŠ æ­£åˆ™åŒ–é¡¹æ¥é˜²æ­¢è¿‡æ‹Ÿåˆ**ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–ä¼˜åŒ–ç®—æ³•å¦‚ Adamã€Adagrad ç­‰æ¥æ›¿ä»£éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚

- Softmax å›å½’ç®—æ³•çš„æ¨¡å‹

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830034.png)

- æˆæœ¬å‡½æ•° ä»£ä»·å‡½æ•°cost function  
  loss functionå®šä¹‰  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830035.png)

- è¾“å‡ºå±‚è®¡ç®—æ–¹å¼  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830036.png)  
  è¾“å‡ºå±‚ä¹Ÿå«ä½œsoftmaxå±‚ï¼Œè¾“å‡ºçš„Kç»´å‘é‡aï¼Œä¸­çš„æ¯ä¸€ä¸ªåˆ†é‡éƒ½ä¸z1-z10æœ‰å…³ç³»ï¼Œè¿™ä¸ªå’Œä¹‹å‰å­¦çš„ä¸å¤ªä¸€æ ·

#### 7.5.2 softmax æ”¹è¿›å®ç°ï¼Œæ›´åŠ ç²¾ç¡®

ç†è§£ä¸åŒçš„è®¡ç®—æ–¹å¼çš„ç²¾åº¦æ˜¯ä¸åŒçš„ï¼Œæœ‰çš„ä¼šåœ¨è®¡ç®—æœºå­˜å‚¨è¿‡ç¨‹ä¸­ä¼´éšå€¼ç²¾åº¦çš„æŸå¤±  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830037.png)  
å½“output layer å±‚ä¸ºsigmoid å‡½æ•°ï¼Œç²¾ç¡®åº¦ä¸å¤ªå½±å“ï¼Œä½†å½“æ˜¯softmaxæ¿€æ´»å‡½æ•°æ—¶ï¼Œéœ€è¦æ”¹è¿›ï¼  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830038.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830039.png)

> ä¹‹æ‰€ä»¥æ˜¯linearæ˜¯å› ä¸ºä¸‹é¢è®¾å®šä¸ºTrueä¹‹åï¼Œsoftmaxä¸å†å•ç‹¬è®¡ç®—ï¼Œåªåœ¨è®¡ç®—costæ—¶åµŒå…¥å†…éƒ¨ä¸€èµ·ç®—äº†ã€‚è¿™æ ·è¾“å‡ºå±‚åªä¼šè¾“å‡ºZçš„å€¼ï¼Œä¸å†å¸¦å…¥softmaxè®¡ç®—äº†

**å¯ä»¥é¿å…åœ¨è®¡ç®— softmax æ“ä½œæ—¶å‡ºç°æ•°å€¼ä¸ç¨³å®šçš„æƒ…å†µ**ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç®€åŒ–ä»£ç å®ç°ã€‚å¦‚æœä¸å°† from\_logits è®¾ç½®ä¸º Trueï¼Œåˆ™åœ¨è¿›è¡Œ softmax è½¬æ¢æ—¶éœ€è¦æ‰‹åŠ¨å¯¹ logits è¿›è¡ŒæŒ‡æ•°è¿ç®—å’Œé™¤æ³•ï¼Œè¿™æ ·çš„å®ç°è¾ƒä¸ºç¹çã€‚

#### 7.5.3 å¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830040.png)  
è¾“å‡ºå€¼yæ˜¯ä¸€ä¸ªå‘é‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ•°  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830041.png)  
ä¸èƒ½ç”¨softmaxï¼Œå› ä¸ºæ¯”å¦‚æ—¢æœ‰äººåˆæœ‰è½¦æ— æ³•å¤„ç†ï¼Œå¯¹æ¯ä¸ªåˆ†é‡ç”¨sigmoid

### 7.6 é«˜çº§ä¼˜åŒ–æ–¹æ³•

#### 7.6.1 Adam ç®—æ³• è‡ªé€‚åº”è·ä¼°è®¡ â€”â€”è‡ªåŠ¨è°ƒèŠ‚å­¦ä¹ ç‡å¤§å°

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830042.png)  
éœ€è¦ä¸€ä¸ªé»˜è®¤çš„å­¦ä¹ ç‡ï¼Œå»ºè®®å¯ä»¥é€‰ä¸€ä¸ªå¤§ç‚¹ï¼Œä¸€ä¸ªå°ç‚¹çš„å¤šè¯•

### 7.7 å…¶ä»–ç½‘ç»œå±‚çš„ç±»å‹

- dense layer å¯†é›†å±‚å°±æ˜¯å…¨è¿æ¥å±‚  
  ä¸€ç§éšè—å±‚ï¼Œå…¶ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å‡ä¸ä¸‹ä¸€ä¸ªéšè—å±‚ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ç›¸è¿ã€‚
- convolutional layer å·ç§¯å±‚  
  ä¾‹å­ï¼šå¿ƒç”µå›¾è¯†åˆ«ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¿ƒè„ç—…ï¼ŒäºŒåˆ†ç±»  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830043.png)  
  éœ€è¦è€ƒè™‘çš„å‚æ•°ï¼š  
  å•ä¸ªç¥ç»å…ƒåº”è¯¥è§‚ å¯Ÿçš„è¾“å…¥çª—å£æœ‰å¤šå¤§ï¼Ÿ  
  ä¸€å±‚åº”è¯¥æœ‰å‡ ä¸ªç¥ç»å…ƒï¼Ÿ

## å…«ã€ç»†èŠ‚

### 8.1 ä½¿ç”¨æµ‹è¯•é›†è¯„ä¼°æ¨¡å‹æ€§èƒ½

- åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›† 8 2 7/3  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830044.png)
- è®¡ç®—Jtest ã€Jtrain è¡¡é‡æ¨¡å‹åœ¨æµ‹è¯•é›†åˆè®­ç»ƒé›†ä¸Šçš„ã€ä¸åŒ…æ‹¬æ­£åˆ™åŒ–é¡¹

1. å¯¹äºçº¿æ€§å›å½’é—®é¢˜ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830045.png)  
2\. åˆ†ç±»é—®é¢˜  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830046.png)  
Jtest(W,b)æ˜¯æµ‹è¯•é›†ä¸­**è¢«é”™è¯¯åˆ†ç±»çš„éƒ¨åˆ†**ã€‚  
Jtrain(W,b)æ˜¯è®­ç»ƒé›†ä¸­**è¢«é”™è¯¯åˆ†ç±»çš„éƒ¨åˆ†**ã€‚

### 8.2 æ¨¡å‹é€‰æ‹© \\ äº¤å‰éªŒè¯é›†

ä¸€æ—¦å‚æ•°w,bè¢«æ‹Ÿåˆåˆ°è®­ç»ƒé›†ï¼Œ**è®­ç»ƒè¯¯å·®Jtrain(W,b)å°±å¯èƒ½ä½äºå®é™…çš„æ³›åŒ–è¯¯å·®**ã€‚  
Jtest(W,b)æ¯”Jtrain(W,b)èƒ½æ›´å¥½åœ°ä¼°è®¡æ¨¡å‹å¯¹æ–°æ•°æ®çš„æ¦‚æ‹¬ç¨‹åº¦ã€‚  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830047.png)  
1 è®­ç»ƒé›†trainç”¨æ¥è®­ç»ƒå‚æ•°wå’Œbï¼Œè€Œæµ‹è¯•é›†testç”¨æ¥é€‰æ‹©å¤šé¡¹å¼æ¨¡å‹ï¼ˆå³å‚æ•°dï¼‰ï¼Œè®­ç»ƒé›†ä¸èƒ½è¯„ä¼°wå’Œbçš„å¥½åï¼Œç±»ä¼¼çš„æµ‹è¯•é›†ä¹Ÿä¸èƒ½ç”¨æ¥è¯„ä¼°å‚æ•°dçš„å¥½åã€‚wï¼Œbä¸dä¸€æ ·éƒ½æ˜¯ç»è¿‡å­¦ä¹ å¾—åˆ°çš„ï¼Œé‚£ä¹ˆå½“ç„¶éƒ½ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚  
2\. æ ¹æ®æµ‹è¯•é›†è¯¯å·®é€‰æ‹©çš„å‚æ•°dï¼Œæ‰€ä»¥å¯èƒ½æ˜¯ä¹è§‚ä¼°è®¡ã€‚**ä¸€ä¸ªåªè€ƒè™‘åˆ°è®­ç»ƒé›†è¯¯å·®Jtrainï¼Œä¸€ä¸ªåªè€ƒè™‘åˆ°æµ‹è¯•é›†è¯¯å·®Jtestï¼Œéƒ½ä¸å…¨é¢**ï¼Œæ‰€ä»¥æ˜¯**ä¹è§‚é¢„æµ‹**

- äº¤å‰éªŒè¯é›†ã€å¼€å‘é›†ã€éªŒè¯é›† dev set  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830048.png)  
  validation error äº¤å‰éªŒè¯è¯¯å·®  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830049.png)  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830050.png)  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830051.png)

> ç†è§£ï¼šå…ˆé€šè¿‡è®­ç»ƒé›†æ‹Ÿåˆw,b. ç„¶åé€šè¿‡äº¤å‰é›†é€‰æ‹©å‡ºæœ€ä¼˜çš„æ¨¡å‹ä¹Ÿå³å‚æ•°dï¼Œæœ€åç”¨é€‰æ‹©å‡ºæ¥çš„æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸­ä¼°è®¡**æ³›åŒ–èƒ½åŠ›**  
> å°±æ˜¯ä¸€ä¸ªè®­ç»ƒå‚æ•°wbï¼Œä¸€ä¸ªæŒ‘é€‰æœ€åˆé€‚çš„ä¸€ä¸ªæ¨¡å‹ï¼Œtestç”¨æ¥ç®—è¯¯å·®ï¼ˆæ•²å®šæœ€ç»ˆæ¨¡å‹ï¼Œæ‰èƒ½åœ¨testé›†ä¸­è¯„ä¼°ï¼‰

### 8.3 åå·® æ–¹å·® bias variance

**è®¡ç®—Jtrain Jcv æ¯”è¾ƒå¤§å°ï¼Œæ¥åˆ¤æ–­ç®—æ³•æ˜¯å¦é«˜åå·®ã€é«˜æ–¹å·®**

> åœ¨ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ä¸­ï¼Œé«˜æ–¹å·®ï¼ˆhigh varianceï¼‰é€šå¸¸æŒ‡æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®çš„è¿‡åº¦æ‹Ÿåˆï¼Œä»è€Œå¯¼è‡´åœ¨æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®ä¸Šè¡¨ç°è¾ƒå·®çš„æƒ…å†µã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„ç›®æ ‡æ˜¯åœ¨é«˜åå·®å’Œé«˜æ–¹å·®ä¹‹é—´å–å¾—å¹³è¡¡ï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„æ³›åŒ–æ€§èƒ½ã€‚ï¼ˆChatGPTï¼‰

- ä»Jtrain å’ŒJcv å¤§å°æ¥ç†è§£ åå·®å’Œæ–¹å·®

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830052.png)

- å¦ä¸€ä¸ªè§’åº¦ é«˜æ¬¡é¡¹å¤§å°  
  å½“é«˜æ¬¡é¡¹è¶Šæ¥è¶Šå¤§æ—¶å€™ï¼ŒJtrainä¼šä¸‹é™ï¼›æ¬¡é¡¹å¤ªå°ï¼Œæ¬ æ‹Ÿåˆï¼Œjcvå¾ˆå¤§åœ¨äº¤å‰éªŒè¯é›†ä¸Šæ•ˆæœä¸å¥½ï¼Œå½“æ¬¡é¡¹å¤ªå¤§ï¼Œè¿‡æ‹Ÿåˆï¼Œjcvä¹Ÿå¾ˆå¤§ï¼Œåœ¨ä¸­é—´  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830053.png)

> åœ¨ç¥ç»ç½‘ç»œæ‹Ÿåˆè¿‡ç¨‹ä¸­ï¼Œé«˜æ–¹å·®å’Œé«˜åå·®å¯èƒ½ä¼šåŒæ—¶å­˜åœ¨![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830055.png)

### 8.4 æ­£åˆ™åŒ–å‚æ•° l a m d a lamda lamdaå¯¹ åå·®ã€æ–¹å·®å½±å“ | å¦‚ä½•åˆ©ç”¨ äº¤å‰éªŒè¯ é€‰åˆ™æ­£åˆ™åŒ–å‚æ•°lamda

**æ­£åˆ™åŒ–å¦‚ä½•å½±å“ç®—æ³•çš„åå·®å’Œæ–¹å·®ï¼Œä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨æ­£åˆ™åŒ–**ï¼Ÿ

> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830056.png) å½“lamda å¾ˆå¤§ï¼Œç®—æ³•è§†å›¾ä¿æŒw<sup>2</sup>è¶Šå°ï¼Œå¯¼è‡´å‚æ•°å¾ˆæ¥è¿‘0ï¼Œæœ€åæ¨¡å‹å°±ä¼šæ¥è¿‘fx = b ï¼Œæ¬ æ‹Ÿåˆ  
> å½“lamdaå¾ˆå°ï¼Œæç«¯ç‚¹ä¸º0ï¼Œå°±å˜æˆäº†æ²¡æœ‰æ­£åˆ™åŒ–åŒ–çš„æŸå¤±å‡½æ•°Jï¼Œä¼šè¿‡æ‹Ÿåˆ  
> å¦‚ä½•é€‰æ‹©lamda ï¼Ÿï¼Œåˆ©ç”¨äº¤å‰éªŒè¯

- å¦‚ä½•é€‰æ‹©lamdaï¼Œåˆ©ç”¨äº¤å‰éªŒè¯é›†Jcv

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830057.png)

> ç±»ä¼¼æ¨¡å‹é€‰æ‹©ï¼Œä»lamda=0å¼€å§‹è®¡ç®—Jtrainæ‹Ÿåˆå‡ºwbå‚æ•°ï¼Œç„¶ååœ¨äº¤å‰éªŒè¯é›†cvä¸Šè®¡ç®—Jcvè¯¯å·®ï¼Œæ¯æ¬¡æŠŠlamdaå˜å¤§2å€ï¼Œ é€‰æ‹©æœ€å°çš„ï¼Œæœ€ååœ¨testæµ‹è¯•é›†è¯„ä¼°Jtestï¼Œè¾¾åˆ°æ³›åŒ–

ä»**Jcv -Jtrain â€”â€” lamda å›¾åƒç†è§£**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830058.png)

### 8.5 æŒ‡å®šä¸€ä¸ªç”¨äºæ€§èƒ½è¯„ä¼°çš„åŸºå‡† baseline =ã€‹åˆ¤æ–­æ˜¯å¦æœ‰é«˜åå·®ã€é«˜æ–¹å·®çš„æƒ…å†µ

ä¾‹å­ è¯­éŸ³è¯†åˆ«

1. åŸºå‡†baseline performance å’ŒJtrain ä¹‹é—´çš„è·ç¦»ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰ä¸€ä¸ªé«˜åå·®biasé—®é¢˜
2. Jtrain å’ŒJcvä¹‹é—´çš„è·ç¦»å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰ä¸€ä¸ªé«˜æ–¹å·®variance

> å½“Jtrain>>Jcv ,æœ‰é«˜æ–¹å·®

### 8.6 é€šè¿‡å­¦ä¹ æ›²çº¿=ã€‹åˆ¤æ–­æ˜¯å¦æœ‰é«˜åå·®ã€é«˜æ–¹å·®

å¦ˆçš„ï¼Œå†™äº†ï¼Œå¿˜è®°ä¿å­˜ï¼Œå…¨æ²¡äº†ï¼ï¼ï¼ï¼ï¼ï¼

### 8.7 è¯¯å·®åˆ†æ

- åƒåœ¾é‚®ä»¶åˆ†ç±»ä¾‹å­  
  äººå·¥åˆ†æé”™è¯¯åˆ†ç±»çš„100å°é‚®ä»¶ï¼ˆå¦‚æœå¾ˆå¤§ï¼Œå°±æŒ‰æ¯”ä¾‹æŠ½å–ï¼‰  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830059.png)  
  æ‰¾å‡ºå½±å“å¤§çš„ç±»åˆ«ï¼Œä¸“æ³¨äºæ·»åŠ æ›´å¤šå…¸å‹çš„é”™è¯¯çš„ä¾‹å­ï¼

### 8.8 æ·»åŠ æ›´å¤šæ•°æ®çš„æŠ€å·§

#### æ•°æ®å¢å¼º

å¯¹äºå›¾åƒæ•°æ®ï¼Œæ‰­æ›²  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830060.png)  
å¯¹äºéŸ³é¢‘æ•°æ® ã€æ·»åŠ å™ªå£°  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830061.png)

#### æ•°æ®åˆæˆ

ä¸€èˆ¬ç”¨äºè®¡ç®—æœºè§†è§‰å¹²æ‰°  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830062.png)

æœ‰ä¸€äº›æ—¶å€™ï¼Œå…³æ³¨æ•°æ®æ˜¯å¸®åŠ©ç®—æ³•æé«˜æ€§èƒ½çš„æœ‰æ•ˆæ–¹æ³•ï¼  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830063.png)

### 8.9 è¿ç§»å­¦ä¹  transfer learningï¼ˆç›‘ç£é¢„è®­ç»ƒï¼‰

ä½œç”¨ï¼šè®©ä½ ç”¨æ¥è‡ªä¸åŒä»»åŠ¡çš„æ•°æ®æ¥è§£å†³å½“å‰çš„ä»»åŠ¡

- ä¾‹å­ï¼šæŠŠåŠ¨ç‰©è¯†åˆ«è¿ç§»åˆ°0-9æ•°å­—è¯†åˆ«  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830064.png)

1. å¾®è°ƒæ–¹æ³•ä¸€ï¼ˆ**è®­ç»ƒé›†å¾ˆå°**ï¼‰  
   **å‰4ä¸ªå‚æ•°ä»ç„¶ä¿ç•™**ï¼Œåªéœ€è¦æ›´æ–°è¾“å‡ºå±‚çš„å‚æ•°ï¼Œåˆ©ç”¨gd æˆ–è€…adamä¼˜åŒ–ç®—æ³•æ¥æœ€å°åŒ–ä»£ä»·å‡½æ•°

2. å¾®è°ƒæ–¹æ³•äºŒï¼ˆ**è®­ç»ƒé›†å¾ˆå¤§**ï¼‰  
   é‡æ–°è®­ç»ƒæ‰€æœ‰å‚æ•°ï¼Œä½†**å‰å››å±‚çš„å‚æ•°è¿˜æ˜¯ç”¨ä¸Šé¢çš„å€¼ä½œä¸ºåˆå§‹å€¼**ï¼

> 1.å› ä¸ºä¸¤ä¸ªç½‘ç»œçš„æœ¬è´¨éƒ½æ˜¯å›¾åƒåˆ†ç±»ï¼Œæ‰€ä»¥åœ¨éšè—å±‚çš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯ç›¸ä¼¼ç”šè‡³ä¸€æ ·çš„  
> 2.æ‰€ä»¥ç›´æ¥æŠŠç¬¬ä¸€ä¸ªç½‘ç»œçš„éšè—å±‚æ‹¿è¿‡æ¥ç”¨ï¼Œå¯¹è¾“å‡ºå±‚é‡æ–°è®­ç»ƒå°±èƒ½å®ç°æ–°çš„åŠŸèƒ½  
> 3.ç›¸å½“äºèºä¸åˆ€çš„åˆ€æŸ„éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æŠŠåå­—åˆ€åˆ€å¤´æ¢æˆä¸€å­—åˆ€ä½œç”¨å°±ä¸ä¸€æ ·äº†  
> ä¸‹é¢çš„å›¾å¯ä»¥å¸®ä½ ç†è§£è¿ç§»å­¦ä¹ çš„åŸç†ï¼š  
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830065.png)  
> ç¥ç»ç½‘ç»œæ¯ä¸€å±‚è®­ç»ƒå®ƒå­¦ä¼šæ£€æµ‹è¾¹ç¼˜ã€æ‹è§’ã€æ›²çº¿å’ŒåŸºæœ¬å½¢çŠ¶

- é¢„è®­ç»ƒ  
  **ç›‘ç£é¢„è®­ç»ƒsupervised pretraining**ï¼šé¦–å…ˆåœ¨å¤§å‹æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œç„¶ååœ¨è¾ƒå°çš„æ•°æ®é›†ä¸Šè¿›è¡Œè¿›è¡Œå‚æ•°**å¾®è°ƒ**ï¼ˆfine tuningï¼‰åˆ©ç”¨å·²ç»åˆå§‹åŒ–çš„æˆ–è€…ä»é¢„è®­ç»ƒæ¨¡å‹è·å–çš„å‚æ•°ï¼Œè¿è¡Œgdï¼Œè¿›ä¸€æ­¥è¿›è¡Œå¾®è°ƒæƒé‡ï¼Œä»¥é€‚åº”æ‰‹å†™æ•°å­—è¯†åˆ«ä»»åŠ¡  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830066.png)

> ä»€ä¹ˆæ˜¯å¾®è°ƒï¼Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼Œä½ ä¸‹è½½äº†åˆ«è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œï¼Œè‡ªå·±ä½¿ç”¨æ›´å°çš„æ•°æ®é›†50 100å¼ ç­‰ï¼Œæ¥è®­ç»ƒè¿™ä¸ªç½‘ç»œ

### 8.10å€¾æ–œæ•°æ®é›†çš„è¯¯å·®æŒ‡æ ‡ Error metrics for skewed datasets

- æ•°æ®å€¾æ–œ  
  **æŸä¸ªç±»åˆ«çš„æ ·æœ¬æ•°åªæœ‰å¦ä¸€ä¸ªç±»åˆ«çš„1/10ï¼Œè¿™ä¸ªæ•°æ®é›†å°±æ˜¯å€¾æ–œçš„**ã€‚è¿™ç§æƒ…å†µä¹Ÿå¸¸å¸¸å‡ºç°åœ¨è¯¸å¦‚**è¯ˆéª—æ£€æµ‹ã€åŒ»å­¦è¯Šæ–­ã€ç½•è§äº‹ä»¶é¢„æµ‹**ç­‰é¢†åŸŸä¸­ï¼Œå› ä¸ºè¿™äº›é—®é¢˜ä¸­**æ­£ä¾‹ï¼ˆpositiveï¼‰çš„æ•°é‡é€šå¸¸æ¯”è´Ÿä¾‹ï¼ˆnegativeï¼‰å°‘å¾—å¤š**ã€‚

- ä¾‹å­ï¼š ç½•è§ç—‡é¢„æµ‹  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830067.png)  
  ä½¿ç”¨ä¸åŒçš„è¯¯å·®é‡åº¦ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ†ç±»è¯¯å·®!

#### 8.10.1 ç²¾ç¡®ç‡å’Œå¬å›ç‡ Precision/ recall ã€æ··æ·†çŸ©é˜µ

å¯¹äºè¿™ä¸ªç½•è§ç—…è¯†åˆ«çš„ä¾‹å­ï¼š  
**ç²¾ç¡®ç‡**ï¼šå°±æ˜¯é¢„æµ‹ä¸ºé˜³æ€§çš„ç—…äººä¸­ çœŸæ­£ä¸ºé˜³æ€§çš„äººçš„æ¯”ä¾‹ï¼ˆ**æ‰¾çš„å¯¹** ï¼‰  
**å¬å›ç‡**ï¼šåœ¨æ‰€æœ‰æ‚£æœ‰ç½•è§ç—…çš„äººä¸­ï¼Œæˆ‘ä»¬çœŸæ­£æ­£ç¡®æ£€æµ‹çš„æ¯”ä¾‹ï¼ˆ**é˜³äº†çš„äººï¼Œæœ‰å¤šå°‘è¢«æ­£ç¡®çš„æ£€æµ‹å‡ºæ¥äº†ï¼Œæ‰¾çš„å…¨**ï¼‰  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830068.png)

åœ¨åŒ»å­¦è¯Šæ–­é¢†åŸŸä¸­ï¼Œé€šå¸¸æ›´å…³æ³¨å¬å›ç‡ï¼Œå› ä¸ºæ¼è¯Šç½•è§ç—…æ‚£è€…å¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡åæœ

---

- æ··æ·†çŸ©é˜µ

|                    | Actual Positive | Actual Negative |
| ------------------ | --------------- | --------------- |
| Predicted Positive | TP              | FP              |
| Predicted Negative | FN              | TN              |

å·¦ä¸Šè§’æ˜¯çœŸæ­£ä¾‹ï¼ˆTrue Positiveï¼ŒTPï¼‰ï¼Œè¡¨ç¤ºæ¨¡å‹æ­£ç¡®é¢„æµ‹å‡ºäº†æ­£ä¾‹ï¼›  
å³ä¸Šè§’æ˜¯å‡æ­£ä¾‹ï¼ˆFalse Positiveï¼ŒFPï¼‰ï¼Œè¡¨ç¤ºæ¨¡å‹å°†è´Ÿä¾‹é”™è¯¯é¢„æµ‹ä¸ºæ­£ä¾‹ï¼›  
å·¦ä¸‹è§’æ˜¯å‡åä¾‹ï¼ˆFalse Negativeï¼ŒFNï¼‰ï¼Œè¡¨ç¤ºæ¨¡å‹å°†æ­£ä¾‹é”™è¯¯é¢„æµ‹ä¸ºè´Ÿä¾‹ï¼›  
å³ä¸‹è§’æ˜¯çœŸåä¾‹ï¼ˆTrue Negativeï¼ŒTNï¼‰ï¼Œè¡¨ç¤ºæ¨¡å‹æ­£ç¡®é¢„æµ‹å‡ºäº†è´Ÿä¾‹ã€‚

- ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰  
  æ˜¯æŒ‡è¢«åˆ†ç±»å™¨**æ­£ç¡®è¯†åˆ«ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ•°**å **æ‰€æœ‰åˆ†ç±»å™¨åˆ¤å®šä¸ºæ­£ä¾‹çš„æ ·æœ¬æ•°çš„æ¯”ä¾‹**ï¼Œå³ï¼š  
  P r e c i s i o n = T P T P + F P Precision=\\frac{TP}{TP+FP} Precision\=TP+FPTP  
  å…¶ä¸­ï¼Œ**TPè¡¨ç¤ºçœŸæ­£ä¾‹ï¼ˆTrue Positiveï¼‰**ï¼Œå³å®é™…ä¸ºæ­£ä¾‹ä¸”è¢«åˆ†ç±»å™¨æ­£ç¡®è¯†åˆ«çš„æ ·æœ¬æ•°ï¼›**FPè¡¨ç¤ºå‡æ­£ä¾‹ï¼ˆFalse Positiveï¼‰**ï¼Œå³å®é™…ä¸ºè´Ÿä¾‹ä½†è¢«åˆ†ç±»å™¨é”™è¯¯è¯†åˆ«ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ•°ã€‚

- å¬å›ç‡ï¼ˆRecallï¼‰  
  æ˜¯æŒ‡è¢«åˆ†ç±»å™¨æ­£ç¡®è¯†åˆ«ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ•°**å æ‰€æœ‰å®é™…ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ•°çš„æ¯”ä¾‹**ï¼Œå³ï¼š  
  R e c a l l = T P T P + F N Recall=\\frac{TP}{TP+FN} Recall\=TP+FNTP  
  å…¶ä¸­ï¼ŒTPè¡¨ç¤ºçœŸæ­£ä¾‹ï¼ˆTrue Positiveï¼‰ï¼Œå³å®é™…ä¸ºæ­£ä¾‹ä¸”è¢«åˆ†ç±»å™¨æ­£ç¡®è¯†åˆ«çš„æ ·æœ¬æ•°ï¼›**FNè¡¨ç¤ºå‡è´Ÿä¾‹ï¼ˆFalse Negativeï¼‰**ï¼Œå³å®é™…ä¸ºæ­£ä¾‹ä½†è¢«åˆ†ç±»å™¨é”™è¯¯è¯†åˆ«ä¸ºè´Ÿä¾‹çš„æ ·æœ¬æ•°ã€‚

#### 8.10.2 ç²¾ç¡®ç‡ï¼ˆæ‰¾çš„å¯¹ï¼‰å’Œå¬å›ç‡ï¼ˆæ‰¾çš„å…¨ï¼‰çš„æƒè¡¡ã€F1score

æˆ‘ä»¬å°†æ‚£ç—…çš„æ ·æœ¬æ ‡è®°ä¸ºæ­£ç±»ï¼Œæœªæ‚£ç—…çš„æ ·æœ¬æ ‡è®°ä¸ºè´Ÿç±»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹

- 1. **æ‰‹åŠ¨é€‰æ‹©**ä¸€ä¸ªé˜ˆå€¼æ¥æƒè¡¡ç²¾åº¦å’Œå¬å›ç‡

å¦‚æœæ²»ç—…çš„ä»£ä»·å¾ˆå¤§ï¼Œæ‚£ç—…åæœä¸éš¾ä¹ˆä¸¥é‡ï¼Œåªåœ¨æˆ‘ä»¬**ååˆ†æœ‰æŠŠæ¡**çš„æƒ…å†µä¸‹å»é¢„æµ‹y=1ï¼Œè®¾ç½®**æ›´é«˜çš„é˜ˆå€¼ï¼ˆå¦‚0.7ï¼‰**ï¼Œè¿™æ ·**precisionä¼šå¢åŠ ï¼ˆå› ä¸ºæ˜¯ååˆ†æœ‰æŠŠæ¡ï¼Œæ‰¾çš„å¯¹çš„æ¦‚ç‡å¤§äº†ï¼‰**ï¼›**recallä¼šå‡å°‘ï¼ˆå‡é˜´æ€§FNçš„ç»“æœå¢å¤šï¼Œå³å®é™…æ‚£ç—…çš„æ ·æœ¬è¢«é”™è¯¯åœ°åˆ¤æ–­ä¸ºæœªæ‚£ç—…ï¼‰**ï¼Œ

> å¦‚æœæˆ‘ä»¬å°†é˜ˆå€¼è®¾ç½®å¾—æ¯”è¾ƒé«˜ï¼Œæ¨¡å‹ä¼šæ›´å€¾å‘äºå°†æœªæ‚£ç—…çš„æ ·æœ¬åˆ¤æ–­ä¸ºè´Ÿç±»ï¼Œè¿™æ ·ä¼šå¯¼è‡´å‡é˜´æ€§çš„ç»“æœå¢å¤šï¼Œå³å®é™…æ‚£ç—…çš„æ ·æœ¬è¢«é”™è¯¯åœ°åˆ¤æ–­ä¸ºæœªæ‚£ç—…ï¼Œä»è€Œå¯¼è‡´å¬å›ç‡recallçš„ä¸‹é™ã€‚ä½†æ˜¯ï¼Œç”±äºæ­£ç±»è¢«é”™è¯¯åœ°é¢„æµ‹ä¸ºè´Ÿç±»çš„æƒ…å†µå‡å°‘äº†ï¼Œæ‰€ä»¥ç²¾åº¦precisionä¼šéšä¹‹æé«˜ã€‚

å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬**ä¸æƒ³æ¼æ‰ç½•è§ç—…ç—…ä¾‹**ï¼Œæ²»ç–—é£é™©ä¸å¤§ï¼Œä½†ä¸æ²»ç–—çš„ç»“æœå¾ˆåï¼Œå¯ä»¥**å‡ä½é˜ˆå€¼**ï¼Œç»“æœè·Ÿä¸Šé¢ç›¸å

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830069.png)

æ€»ç»“ï¼š  
æˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥é€‰æ‹©æ›´æ³¨é‡ç²¾ç¡®ç‡è¿˜æ˜¯å¬å›ç‡ã€‚å¯¹äºä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰ä¸åŒçš„éœ€æ±‚ã€‚å¦‚æœæˆ‘ä»¬æ›´å…³å¿ƒæŸ¥å‡†ç‡ï¼Œé‚£ä¹ˆå°±éœ€è¦é€‰æ‹©**æ›´é«˜çš„ç²¾ç¡®ç‡é˜ˆå€¼**ï¼Œè¿™æ ·å¯ä»¥**å‡å°‘å‡é˜³æ€§**çš„æƒ…å†µï¼Œ**æé«˜é¢„æµ‹ç»“æœçš„å‡†ç¡®æ€§**ï¼›å¦‚æœæˆ‘ä»¬æ›´å…³å¿ƒæŸ¥å…¨ç‡ï¼Œé‚£ä¹ˆå°±éœ€è¦é€‰æ‹©æ›´**ä½çš„ç²¾ç¡®ç‡é˜ˆå€¼**ï¼Œè¿™æ ·å¯ä»¥**å‡å°‘å‡é˜´æ€§**çš„æƒ…å†µï¼Œ**æé«˜é¢„æµ‹ç»“æœçš„å¬å›ç‡**

---

> é«˜ç²¾ç¡®ç‡ï¼šåˆ¤å®šä¸ºtrueçš„ç½®ä¿¡åº¦é«˜  
> é«˜å¬å›ç‡ï¼šåˆ¤å®šä¸ºfalseçš„ç½®ä¿¡åº¦é«˜  
> ç½®ä¿¡åº¦æ˜¯æŒ‡ä¸€ä¸ªç»Ÿè®¡æ¨æ–­ä¸­ï¼Œå¯¹äºä¸€ä¸ªå‚æ•°æˆ–è€…å‡è®¾æ‰€å¾—åˆ°çš„æ¨æ–­ç»“æœçš„å¯ä¿¡ç¨‹åº¦æˆ–è€…ç¡®å®šæ€§ç¨‹åº¦ã€‚ç½®ä¿¡åº¦é€šå¸¸ä½¿ç”¨**ç½®ä¿¡åŒºé—´**æ¥åº¦é‡ï¼Œè¡¨ç¤ºå‚æ•°æˆ–å‡è®¾åœ¨ä¸€å®šç½®ä¿¡æ°´å¹³ä¸‹çš„å¯èƒ½å–å€¼èŒƒå›´ã€‚  
> **ç½®ä¿¡åº¦é«˜è¡¨ç¤ºæ¨æ–­æ‰€å¾—çš„ç»“æœè¶Šå¯ä¿¡**ï¼Œå³åœ¨ä¸€å®šç½®ä¿¡æ°´å¹³ä¸‹ï¼Œå¾—åˆ°çš„ç½®ä¿¡åŒºé—´è¶Šå°ï¼Œè¯´æ˜å‚æ•°æˆ–å‡è®¾çš„å¯èƒ½å–å€¼èŒƒå›´è¶Šå°ï¼Œç»“æœè¶Šç²¾ç¡®å¯é ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªæ ·æœ¬çš„ç½®ä¿¡åŒºé—´ä¸º\[2, 6\]ï¼Œåˆ™åœ¨95%çš„ç½®ä¿¡æ°´å¹³ä¸‹ï¼Œè¯¥æ ·æœ¬çš„çœŸå®å€¼æœ‰95%çš„å¯èƒ½åœ¨åŒºé—´\[2, 6\]å†…ã€‚å¦‚æœç½®ä¿¡åº¦æ›´é«˜ï¼Œæ¯”å¦‚99%çš„ç½®ä¿¡æ°´å¹³ï¼Œåˆ™æ ·æœ¬çš„çœŸå®å€¼æœ‰99%çš„å¯èƒ½åœ¨æ›´å°çš„åŒºé—´å†…ï¼Œå¦‚\[2.5, 5.5\]ã€‚

> é˜ˆå€¼çš„é€‰æ‹©ä¼šç›´æ¥å½±å“æ¨¡å‹çš„é¢„æµ‹ç»“æœï¼Œå…¶ä¸­**è¾ƒé«˜çš„é˜ˆå€¼**ä¼šä½¿æ¨¡å‹**æ›´å€¾å‘äºå°†æ ·æœ¬å½’ç±»ä¸ºè´Ÿç±»**ï¼Œè€Œè¾ƒä½çš„é˜ˆå€¼åˆ™ä¼šä½¿æ¨¡å‹æ›´å€¾å‘äºå°†æ ·æœ¬å½’ç±»ä¸ºæ­£ç±»ã€‚  
> ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰1000ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­åªæœ‰10ä¸ªæ˜¯æ‚£ç—…çš„æ­£æ ·æœ¬ã€‚å¦‚æœæˆ‘ä»¬å°†é˜ˆå€¼è®¾ç½®å¾—å¾ˆé«˜ï¼Œæ¯”å¦‚è¯´0.95ï¼Œé‚£ä¹ˆæ¨¡å‹å¯èƒ½åªä¼šå°†å…¶ä¸­ä¸€ä¸ªæ­£æ ·æœ¬é¢„æµ‹ä¸ºæ­£ç±»ï¼Œè€Œå°†å…¶ä½™9ä¸ªæ­£æ ·æœ¬éƒ½åˆ¤æ–­ä¸ºè´Ÿç±»ã€‚è¿™æ ·ï¼Œç²¾åº¦ä¼šå˜å¾—éå¸¸é«˜ï¼Œè¾¾åˆ°99%ä»¥ä¸Šï¼Œä½†æ˜¯å¬å›ç‡åªæœ‰10%ã€‚ç›¸åï¼Œå¦‚æœæˆ‘ä»¬å°†é˜ˆå€¼è®¾ç½®å¾—å¾ˆä½ï¼Œæ¯”å¦‚è¯´0.1ï¼Œé‚£ä¹ˆæ¨¡å‹å¯èƒ½ä¼šå°†å¤§éƒ¨åˆ†æ ·æœ¬éƒ½é¢„æµ‹ä¸ºæ­£ç±»ï¼Œä»è€Œå¬å›ç‡å¾ˆé«˜ï¼Œä½†æ˜¯ç²¾åº¦ä¼šå¾ˆä½ï¼Œå› ä¸ºå¤§å¤šæ•°é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬å®é™…ä¸Šæ˜¯è´Ÿæ ·æœ¬ã€‚å› æ­¤ï¼Œåœ¨è®¾ç½®é˜ˆå€¼æ—¶éœ€è¦å¹³è¡¡å¬å›ç‡å’Œç²¾åº¦ï¼Œæ ¹æ®å®é™…åº”ç”¨æƒ…å†µé€‰æ‹©åˆé€‚çš„é˜ˆå€¼ã€‚

- 2. F1 score è‡ªåŠ¨æƒè¡¡ç²¾åº¦å’Œå¬å›ç‡ï¼Œ

F1 scoreï¼ˆF1å€¼ï¼‰æ˜¯ä¸€ç§ç»¼åˆè¯„ä»·åˆ†ç±»å™¨æ€§èƒ½çš„æŒ‡æ ‡ï¼Œç»“åˆäº†åˆ†ç±»å™¨çš„å‡†ç¡®ç‡å’Œå¬å›ç‡ã€‚å®ƒæ˜¯å‡†ç¡®ç‡å’Œå¬å›ç‡çš„**è°ƒå’Œå¹³å‡æ•°ï¼ˆå–å¹³å‡å€¼çš„æ–¹æ³•ï¼Œæ›´å¼ºè°ƒè¾ƒå°çš„å€¼ï¼‰**ï¼Œé€šå¸¸ç”¨äº**è¯„ä¼°äºŒå…ƒåˆ†ç±»å™¨çš„æ€§èƒ½**ã€‚

F1 score çš„è®¡ç®—å…¬å¼ä¸ºï¼š  
F 1 s c o r e = 2 P r e c i s i o n âˆ— R e c a l l P r e c i s i o n + R e c a l l F1 score=2\\frac{Precision\*Recall}{Precision+Recall} F1score\=2Precision+RecallPrecisionâˆ—Recall

> åœ¨è®¡ç®— F1 score æ—¶ï¼Œç²¾ç¡®ç‡å’Œå¬å›ç‡å¯¹ç»“æœçš„è´¡çŒ®æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼ŒF1 score å¼ºè°ƒäº†ç²¾ç¡®ç‡å’Œå¬å›ç‡åŒç­‰é‡è¦ã€‚  
> å½“ç²¾ç¡®ç‡å’Œå¬å›ç‡å·®å¼‚è¾ƒå¤§æ—¶ï¼ŒF1 score çš„å€¼ä¼šå—åˆ°æœ€å°å€¼çš„å½±å“ã€‚ä¾‹å¦‚ï¼Œå½“ç²¾ç¡®ç‡å¾ˆä½ä½†å¬å›ç‡å¾ˆé«˜æ—¶ï¼ŒF1 score çš„å€¼ä¼šå—åˆ°ç²¾ç¡®ç‡çš„å½±å“è€Œé™ä½ï¼Œå› ä¸º F1 score è€ƒè™‘äº†ä¸¤è€…çš„å¹³å‡å€¼ã€‚

### 8.11 æœºå™¨å­¦ä¹ é¡¹ç›®å®Œæ•´çš„å‘¨æœŸ

![å§  ](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830070.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830071.png)

**MLOps æœºå™¨å­¦ä¹ æ“ä½œ**  
MLOpså°†æœºå™¨å­¦ä¹ é¡¹ç›®ç®¡ç†çš„æ–¹æ³•ä¸è½¯ä»¶å·¥ç¨‹æ–¹æ³•ç›¸ç»“åˆï¼Œä»¥å»ºç«‹é«˜æ•ˆã€å¯é‡å¤ã€å¯ç»´æŠ¤çš„æœºå™¨å­¦ä¹ ç³»ç»Ÿã€‚è¿™ç§æ–¹æ³•å¼ºè°ƒæŒç»­å­¦ä¹ ã€æŒç»­ä¼˜åŒ–å’Œè‡ªåŠ¨åŒ–ï¼Œä»¥ç¡®ä¿æœºå™¨å­¦ä¹ æ¨¡å‹èƒ½å¤Ÿåœ¨ä¸æ–­å˜åŒ–çš„ç¯å¢ƒä¸­ä¿æŒæœ€ä½³çŠ¶æ€ã€‚

## ä¹ã€å†³ç­–æ ‘

- **å†³ç­–1ï¼šå¦‚ä½•é€‰æ‹©åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåˆ†å‰²ä»€ä¹ˆç‰¹å¾ï¼Ÿ**  
  **æœ€å¤§é™åº¦åœ°æé«˜çº¯åº¦**ï¼ˆæˆ–æœ€å°é™åº¦åœ°å‡å°‘ä¸çº¯ï¼‰ã€‚  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830072.png)
- **å†³ç­–2ï¼šä»€ä¹ˆæ—¶å€™åœæ­¢æ‹†åˆ†ï¼Ÿ**
  1. å½“ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå•ä¸€ç±»æ—¶
  2. å½“æ‹†åˆ†ä¸€ä¸ªèŠ‚ç‚¹ä¼šå¯¼è‡´æ ‘è¶…è¿‡æœ€å¤§çš„æ·±åº¦
  3. å½“çº¯åº¦åˆ†æ•°çš„æ”¹è¿›ä½äºä¸€ä¸ªé˜ˆå€¼ï¼ˆè·å¾—çš„ä¿¡æ¯å¢ç›Šå¾ˆå°å°äºé˜ˆå€¼ï¼‰
  4. å½“ä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„ä¾‹å­æ•°é‡ä½äºä¸€ä¸ªé˜ˆå€¼

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830073.png)

### 9.1 è¡¡é‡çº¯åº¦ã€ç†µentropyã€ GiniæŒ‡æ•°

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830074.png)

ç†µï¼ˆEntropyï¼‰é€šå¸¸ç”¨äºè¡¡é‡æ ·æœ¬é›†åˆçš„ä¸ç¡®å®šæ€§å’Œçº¯åº¦ï¼Œä¹Ÿå¯ä»¥**ç†è§£ä¸ºæ ·æœ¬é›†åˆä¸­éšæœºé€‰å–ä¸€ä¸ªæ ·æœ¬ï¼Œå…¶æ‰€åŒ…å«çš„ä¿¡æ¯é‡ï¼Œæ··ä¹±ç¨‹åº¦**ã€‚

ä»¥äºŒåˆ†ç±»é—®é¢˜ä¸ºä¾‹ï¼Œå‡è®¾æ ·æœ¬é›†åˆ D D Dä¸­åŒ…å«æ­£ä¾‹æ ·æœ¬æ•°ä¸º âˆ£ D + âˆ£ |D\_+| âˆ£D+âˆ£ï¼Œåä¾‹æ ·æœ¬æ•°ä¸º âˆ£ D âˆ’ âˆ£ |D\_-| âˆ£Dâˆ’âˆ£ï¼Œåˆ™**æ ·æœ¬é›†åˆ D D Dçš„ç†µå¯ä»¥è¡¨ç¤ºä¸ºï¼ˆç±»ä¼¼é€»è¾‘å›å½’ äºŒåˆ†ç±»é—®é¢˜ç”¨Binary Cross EntropyäºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼‰ï¼š**

Ent â¡ ( D ) = âˆ’ p + log â¡ 2 p + âˆ’ p âˆ’ log â¡ 2 p âˆ’ \\operatorname{Ent}(D) = -p\_+\\log\_2 p\_+ - p\_-\\log\_2 p\_- Ent(D)\=âˆ’p+log2p+âˆ’pâˆ’log2pâˆ’

å…¶ä¸­ï¼Œ p + p\_+ p+å’Œ p âˆ’ p\_- pâˆ’åˆ†åˆ«è¡¨ç¤ºæ ·æœ¬é›†åˆä¸­æ­£ä¾‹å’Œåä¾‹çš„æ¯”ä¾‹ï¼Œå³ï¼š

p + = âˆ£ D + âˆ£ âˆ£ D âˆ£ , p âˆ’ = âˆ£ D âˆ’ âˆ£ âˆ£ D âˆ£ p\_+ = \\frac{|D\_+|}{|D|},\\quad p\_- = \\frac{|D\_-|}{|D|} p+\=âˆ£Dâˆ£âˆ£D+âˆ£,pâˆ’\=âˆ£Dâˆ£âˆ£Dâˆ’âˆ£

å¯ä»¥å‘ç°ï¼Œå½“æ­£ä¾‹å’Œåä¾‹æ¯”ä¾‹ç›¸ç­‰æ—¶ï¼Œå³ p + = p âˆ’ = 0.5 p\_+=p\_-=0.5 p+\=pâˆ’\=0.5æ—¶ï¼Œæ­¤æ—¶çš„ç†µå–æœ€å¤§å€¼ 1 1 1ï¼Œè¡¨æ˜æ­¤æ—¶æ ·æœ¬é›†åˆæœ€ä¸ç¡®å®šï¼Œ**æ ·æœ¬é›†åˆè¶Šä¸çº¯ï¼Œç†µå€¼è¶Š**å¤§ï¼›è€Œå½“æ ·æœ¬é›†åˆä¸­åªåŒ…å«ä¸€ç±»æ ·æœ¬ï¼ˆå³çº¯æ ·æœ¬é›†åˆï¼‰æ—¶ï¼Œ**ç†µå€¼ä¸º 0 0 0ï¼Œè¡¨æ˜æ­¤æ—¶æ ·æœ¬é›†åˆå·²ç»å®Œå…¨ç¡®å®šï¼Œå¾ˆçº¯**ã€‚

åœ¨å†³ç­–æ ‘ç®—æ³•ä¸­ï¼Œç†µå¸¸å¸¸è¢«ç”¨æ¥é€‰æ‹©æœ€ä¼˜åˆ’åˆ†ç‚¹ï¼Œå³**åœ¨æ ·æœ¬çš„æŸä¸ªç‰¹å¾ä¸Šæ ¹æ®ç†µçš„å˜åŒ–é€‰å–æœ€ä¼˜çš„åˆ’åˆ†ç‚¹ï¼Œä½¿å¾—åˆ’åˆ†åçš„æ ·æœ¬å­é›†ä¸­çš„ç†µæœ€å°**ã€‚

- GiniæŒ‡æ•°

GiniæŒ‡æ•°æ˜¯ä¸€ç§ç”¨äºè¡¡é‡æ•°æ®é›†çº¯åº¦çš„æŒ‡æ ‡ï¼Œé€šå¸¸ç”¨äºå†³ç­–æ ‘ç®—æ³•ä¸­ã€‚åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå‡è®¾æœ‰Kä¸ªç±»åˆ«ï¼Œæ•°æ®é›†Dä¸­ç¬¬kç±»æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ä¸º p k p\_k pkï¼Œåˆ™GiniæŒ‡æ•°çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š

G i n i ( D ) = âˆ‘ k = 1 K p k ( 1 âˆ’ p k ) Gini(D) = \\sum\_{k=1}^{K}p\_k(1-p\_k) Gini(D)\=k\=1âˆ‘Kpk(1âˆ’pk)

GiniæŒ‡æ•°è¡¡é‡çš„æ˜¯**ä»æ•°æ®é›†Dä¸­éšæœºé€‰å–ä¸¤ä¸ªæ ·æœ¬ï¼Œå…¶ç±»åˆ«ä¸ä¸€è‡´çš„æ¦‚ç‡**ï¼Œå› æ­¤**GiniæŒ‡æ•°è¶Šå°ï¼Œæ•°æ®é›†çš„çº¯åº¦è¶Šé«˜**ï¼Œåˆ†ç±»æ•ˆæœè¶Šå¥½ã€‚ä¸ç†µç±»ä¼¼ï¼ŒGiniæŒ‡æ•°ä¹Ÿæ˜¯åœ¨0åˆ°1ä¹‹é—´å–å€¼ï¼Œå–å€¼è¶Šå°è¡¨ç¤ºæ•°æ®é›†çš„çº¯åº¦è¶Šé«˜ã€‚

åœ¨å†³ç­–æ ‘ç®—æ³•ä¸­ï¼Œé€‰æ‹©åˆ’åˆ†ç‰¹å¾æ—¶ï¼Œé€šå¸¸ä¼šè®¡ç®—æ¯ä¸ªç‰¹å¾çš„GiniæŒ‡æ•°æˆ–ä¿¡æ¯å¢ç›Šï¼Œä»¥é€‰å–æœ€ä½³çš„åˆ’åˆ†ç‰¹å¾ã€‚

### 9.2 ä¿¡æ¯å¢ç›Š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830075.png)

> p1è¡¨ç¤ºæ ·æœ¬é›†åˆä¸­æ­£ä¾‹ä¹Ÿå³çŒ«çš„æ¯”ä¾‹ï¼ŒwleftæŒ‡çš„æ˜¯å æ ·æœ¬çš„æƒé‡ï¼Œp1 left ä»£è¡¨å·¦ææ­£ä¾‹çš„æ¯”ä¾‹

---

åœ¨å†³ç­–æ ‘ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›**é€šè¿‡é€‰æ‹©æœ€ä¼˜ç‰¹å¾æ¥åˆ’åˆ†æ•°æ®é›†**ï¼Œä»è€Œä½¿åˆ’åˆ†åçš„æ•°æ®é›†æ›´åŠ çº¯å‡€ï¼Œå³ç†µå‡å°‘ã€‚è€Œè¿™ä¸ª**ç†µå‡å°‘çš„é‡å°±è¢«ç§°ä¸ºä¿¡æ¯å¢ç›Š**

ä¿¡æ¯å¢ç›Šæ˜¯ä¸€ç§ç”¨äº**è¡¡é‡ä¸€ä¸ªç‰¹å¾å¯¹åˆ†ç±»ä»»åŠ¡çš„è´¡çŒ®ç¨‹åº¦çš„æŒ‡æ ‡**ï¼Œé€šå¸¸ç”¨äºå†³ç­–æ ‘ç®—æ³•ä¸­ã€‚åœ¨å†³ç­–æ ‘ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé€‰æ‹©ä¸€ä¸ªç‰¹å¾ï¼Œä½¿å¾—é€‰å®šç‰¹å¾åèƒ½å¤Ÿæœ€å¤§ç¨‹åº¦åœ°**æé«˜æ•°æ®çš„çº¯åº¦ï¼ˆå³åˆ†ç±»çš„å‡†ç¡®æ€§**ï¼‰ã€‚ä¿¡æ¯å¢ç›Šçš„è®¡ç®—æ–¹æ³•æ˜¯ï¼šé¦–å…ˆè®¡ç®—æ•°æ®é›†çš„ç†µï¼Œç„¶åè®¡ç®—é€‰å®šç‰¹å¾åçš„æ¡ä»¶ç†µï¼Œä¸¤è€…ç›¸å‡å³ä¸ºè¯¥ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šã€‚**ä¿¡æ¯å¢ç›Šè¶Šå¤§ï¼Œä»£è¡¨è¯¥ç‰¹å¾å¯¹åˆ†ç±»ä»»åŠ¡çš„è´¡çŒ®è¶Šå¤§**ã€‚

### 9.3 ç‹¬çƒ­ç¼–ç One-hot

å‰é¢çš„ä¾‹å­ï¼Œæ¯ä¸ªç‰¹å¾åªèƒ½å–ä¸¤ä¸ªä¸åŒçš„å€¼ï¼Œå¦‚èƒ¡å­æœ‰ã€æ—   
ï¼Œè€³æœµçš„å°–ã€æ¤­åœ†ï¼Œå¯¹äºæœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ç¦»æ•£å€¼çš„ç‰¹å¾ï¼Œä½¿ç”¨one hotç¼–ç   
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830076.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830077.png)

> ä¹‹æ‰€ä»¥å«one hot ï¼Œå› ä¸ºè¿™äº›ç‰¹å¾æ€»æœ‰ä¸€ä¸ªå–1ï¼Œ

ä¸ä»…ä»…é€‚ç”¨äºå†³ç­–æ ‘ï¼Œå¯ä»¥å¯¹åˆ†ç±»ç‰¹å¾è¿›è¡Œç¼–ç ï¼Œä»¥ä¾¿ä½œä¸ºè¾“å…¥é€å…¥ç¥ç»ç½‘ç»œ  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830078.png)

### 9.4 è¿ç»­å€¼ç‰¹å¾

æ–°å¢ä½“é‡ç‰¹å¾ï¼Œæ˜¯è¿ç»­å€¼  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830079.png)  
å°†ç‰¹å¾åˆ’åˆ†ï¼Œè€ƒè™‘ä¸åŒçš„å€¼ï¼Œè®¡ç®—åˆ†éš”åçš„ä¿¡æ¯å¢ç›Šï¼Œ**é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„ï¼Œèƒ½è·å¾—æœ€å¥½ä¿¡æ¯å¢ç›Šçš„é‚£**ä¸ªï¼  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830080.png)

ä¸€èˆ¬çš„åšæ³•ï¼š**å¯¹æ‰€æœ‰çš„æ ·æœ¬æ’åº**ï¼Œæ ¹æ®ä½“é‡å¤§å°æ’åºï¼Œ**å–ä¸­ç‚¹å€¼ï¼Œä½œä¸ºè¿™ä¸ªé˜ˆå€¼çš„å€™é€‰å€¼**

### 9.5 å›å½’æ ‘ regression tree

æ³›åŒ–åˆ°å›å½’é—®é¢˜ï¼Œé¢„æµ‹ä¸€ä¸ªæ•°å­—ï¼Œè€Œä¸æ˜¯åˆ†ç±»é—®é¢˜  
ä¾‹å­ï¼š  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830081.png)  
ç”¨ä¸€ä¸ªå†³ç­–æ ‘æ¥å›å½’  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830082.png)

- é‡æ–°é€‰æ‹©åˆ’åˆ†çš„æ ‡å‡†ï¼Œé‡æ–°ç”Ÿæˆ

åœ¨**åˆ’åˆ†æ—¶**ï¼Œä¸å»è®¡ç®—ä¿¡æ¯å¢ç›Šï¼Œä¸å»è¡¡é‡çº¯åº¦ï¼Œä¸å¦‚**å‡å°‘æ•°æ®çš„æ–¹å·®**ï¼Œç±»ä¼¼ä¿¡æ¯å¢ç›Šï¼Œæˆ‘ä»¬**æµ‹é‡çš„æ˜¯æ–¹å·®çš„å‡å°ï¼Œé€‰æ‹©æ–¹å·®å‡å°‘æœ€å¤§çš„é‚£ä¸ªç‰¹å¾åˆ†ç±»æ ‡å‡†**  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830083.png)

### 9.6 æ ‘é›†åˆ Tree ensemble

å•ä¸ªå†³ç­–æ ‘å—åˆ°æ•°æ®å˜åŒ–çš„å½±å“å¾ˆå¤§ï¼Œå¯¼è‡´ä¸åŒçš„åˆ’åˆ†ï¼Œå½¢æˆå¯èƒ½ä¸åŒçš„æ ‘ï¼Œè®©ç®—æ³•çš„é²æ£’æ€§å˜ä½ï¼›  
ä½¿ç”¨æ ‘é›†åˆï¼Œè®©æ¯ä¸€é¢—æ ‘æŠ•ç¥¨ã€‚  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830084.png)

#### 9.6.1 æœ‰æ”¾å›æŠ½æ ·sampling with replacement ï¼ˆæ„é€ å¤šä¸ªéšæœºçš„è®­ç»ƒé›†ï¼‰

æ„å»ºæ ‘é›†åˆçš„æ–¹å¼å¦‚ä¸‹ï¼šæ„å»ºå¤šä¸ªéšæœºçš„è®­ç»ƒé›†ï¼Œéƒ½ä¸æˆ‘ä»¬æœ€åˆçš„è®­ç»ƒé›†ç•¥æœ‰ä¸åŒ  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830085.png)

#### 9.6.2éšæœºæ£®æ—ç®—æ³•

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830086.png)  
åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œéšæœºé€‰kä¸ªç‰¹å¾å€¼è¿›è¡Œå†³ç­–æ ‘çš„æ„å»º  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830087.png)

åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå½“é€‰æ‹©ç”¨äºåˆ†å‰²çš„ç‰¹å¾æ—¶ï¼Œå¦‚æœæœ‰nä¸ªç‰¹å¾ï¼Œ**åˆ™ä»ç‰¹å¾ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªå­é›†ï¼Œå­é›†å¤§å°ä¸ºk k<n**ï¼Œé€‰æ‹©kä¸ªç‰¹å¾ä½œä¸ºå…è®¸çš„ç‰¹å¾ï¼›ç„¶åä»è¿™kä¸ªç‰¹å¾ä¸­é€‰æ”¶è·æœ€å¤§ä¿¡æ¯å¢ç›Šçš„ç‰¹å¾ä½œä¸ºåˆ†å‰²ç‰¹å¾

---

éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ ç®—æ³•ï¼Œå®ƒç”±å¤šä¸ªå†³ç­–æ ‘ç»„æˆï¼Œæ¯ä¸ªå†³ç­–æ ‘ä¹‹é—´ç›¸äº’ç‹¬ç«‹ã€‚éšæœºæ£®æ—çš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š

1. **éšæœºé€‰å–nä¸ªæ ·æœ¬ä½œä¸ºè®­ç»ƒé›†ï¼Œå¯¹äºæ¯ä¸ªæ ·æœ¬ï¼Œéšæœºé€‰å–kä¸ªç‰¹å¾è¿›è¡Œå†³ç­–æ ‘çš„æ„å»º**ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œ**nå–æ ·æ€»æ•°çš„70%åˆ°80%ï¼Œkå–ç‰¹å¾æ€»æ•°çš„å¹³æ–¹æ ¹**ã€‚
2. å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œéšæœºé€‰å–kä¸ªç‰¹å¾è¿›è¡Œåˆ’åˆ†ï¼Œå¹¶åœ¨é€‰å–çš„ç‰¹å¾ä¸­æ‰¾åˆ°æœ€ä¼˜åˆ’åˆ†ç‰¹å¾ã€‚è¿™é‡Œçš„æœ€ä¼˜åˆ’åˆ†æ˜¯é€šè¿‡è®¡ç®—ä¿¡æ¯å¢ç›Šæˆ–Giniç³»æ•°ç­‰æŒ‡æ ‡å¾—å‡ºçš„ã€‚
3. é‡å¤æ­¥éª¤1å’Œæ­¥éª¤2ï¼Œæ„å»ºå¤šæ£µå†³ç­–æ ‘ã€‚
4. é¢„æµ‹æ—¶ï¼Œå°†æ–°æ•°æ®è¾“å…¥åˆ°æ¯ä¸ªå†³ç­–æ ‘ä¸­ï¼Œå¾—åˆ°æ¯æ£µæ ‘çš„é¢„æµ‹ç»“æœï¼Œç„¶åæ ¹æ®æŠ•ç¥¨æ³•æˆ–å¹³å‡å€¼ç­‰æ–¹æ³•ï¼Œå¾—åˆ°éšæœºæ£®æ—çš„æœ€ç»ˆé¢„æµ‹ç»“æœã€‚

éšæœºæ£®æ—ç®—æ³•å…·æœ‰è‰¯å¥½çš„æ³›åŒ–æ€§èƒ½å’ŒæŠ—å™ªæ€§èƒ½ï¼Œé€šå¸¸è¢«ç”¨äºåˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚

#### 9.6.3 XGBoost

- ç†è§£boostçš„æ€æƒ³  
  æˆ‘ä»¬å…³æ³¨çš„æ˜¯æˆ‘ä»¬è¿˜æ²¡åšå¥½çš„åœ°æ–¹ï¼Œåœ¨æ„å»ºä¸‹ä¸€ä¸ªå†³ç­–æ ‘æ—¶ï¼ŒæŠŠæ›´å¤šçš„æ³¨æ„åŠ›æ”¾åœ¨åšå¾—ä¸å¥½çš„ä¾‹å­ä¸Šï¼Œä¸æ˜¯ä»¥ç›¸ç­‰çš„(1/m)æ¦‚ç‡ä»æ‰€æœ‰çš„ä¾‹å­ä¸­é€‰å–ï¼Œè€Œæ˜¯**æ›´æœ‰å¯èƒ½é€‰å–ä»¥å‰è®­ç»ƒçš„æ ‘æ‰€é”™è¯¯åˆ†ç±»çš„ä¾‹å­**ã€‚

> boosting åˆ»æ„ç»ƒä¹  deliberate practice

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830088.png)

- XGBoost extreme gradient boosting æç«¯æ¢¯åº¦æå‡

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830089.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830090.png)

> XGBoostçš„è®­ç»ƒè¿‡ç¨‹æ˜¯ä¸€ä¸ªé€æ­¥è¿­ä»£çš„è¿‡ç¨‹ã€‚å®ƒé€šè¿‡ä¸æ–­è®­ç»ƒå¤šæ£µå†³ç­–æ ‘ï¼Œå¹¶**ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥å¯¹æ¯æ£µæ ‘çš„æƒé‡è¿›è¡Œä¼˜åŒ–ï¼Œä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°**ã€‚  
> å…·ä½“æ¥è¯´ï¼ŒXGBooståœ¨æ„å»ºæ¯æ£µæ ‘æ—¶ï¼Œä¼šå…ˆæ„å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œç„¶åé€æ­¥å°†æ•°æ®é›†åˆ†é…åˆ°å­èŠ‚ç‚¹ä¸­ã€‚æ¯æ¬¡åˆ†é…æ•°æ®é›†æ—¶ï¼ŒXGBoostéƒ½ä¼šæ ¹æ®ä¸€ä¸ªæŒ‡å®šçš„è¯„ä»·å‡½æ•°æ¥é€‰æ‹©æœ€ä½³çš„ç‰¹å¾è¿›è¡Œåˆ†è£‚ï¼Œå¹¶è®¡ç®—æ¯ä¸ªå­èŠ‚ç‚¹çš„æƒé‡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒXGBoostå¯ä»¥åœ¨ä¸æ–­è¿­ä»£ä¸­æ„å»ºå¤šæ£µæ ‘ï¼Œå¹¶ç»¼åˆå®ƒä»¬çš„é¢„æµ‹ç»“æœæ¥æé«˜æ¨¡å‹çš„å‡†ç¡®ç‡ã€‚

### 9.7 ä½•æ—¶ä½¿ç”¨å†³ç­–æ ‘ã€ç¥ç»ç½‘ç»œ

- å†³ç­–æ ‘

1. å†³ç­–æ ‘å¯ä»¥å¾ˆå¥½å¤„ç†**è¡¨æ ¼æ•°æ®ï¼ˆç»“æ„åŒ–æ•°æ®ï¼‰**
2. è®­ç»ƒå¾ˆå¿«
3. å°å‹çš„å†³ç­–æ ‘å…·æœ‰å¯è§£é‡Šæ€§

- ç¥ç»ç½‘ç»œ

4. é€‚ç”¨äºæ‰€æœ‰ç±»å‹çš„æ•°æ®ï¼Œè¡¨æ ¼å’Œéç»“æ„åŒ–æ•°æ®
5. å¯èƒ½æ¯”è¾ƒæ…¢
6. å¯ä»¥è¿ç§»å­¦ä¹ ã€é¢„è®­ç»ƒ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830091.png)

## åã€æ— ç›‘ç£å­¦ä¹ 

### 10.1 èšç±» clustering

#### 10.1.1 K-meansç®—æ³•åŸç†

- ç†è§£K-meanså¦‚ä½•å·¥ä½œ  
  å…³é”®ä¸¤ä¸ªæ­¥éª¤ï¼š  
  ç¬¬ä¸€æ­¥ï¼ŒæŠŠæ¯ä¸ªç‚¹åˆ†é…ç»™ç°‡è´¨é‡å¿ƒï¼Œåˆ†é…ç»™ç¦»å®ƒæœ€è¿‘çš„ç°‡è´¨å¿ƒï¼›ç¬¬äºŒæ­¥ï¼ŒæŠŠæ¯ä¸ªç°‡è´¨å¿ƒåˆ†é…ç»™å®ƒæ‰€æœ‰ç‚¹çš„å¹³å‡ä½ç½®;ç›´åˆ°ç°‡è´¨å¿ƒæ²¡æœ‰å˜åŒ–  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830092.png)  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830093.png)  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830094.png)  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830095.png)
- ç®—æ³•  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830096.png)

> è®¡ç®—è·ç¦»é‡‡ç”¨L2èŒƒæ•°ä¹Ÿç§°ä¸ºæ¬§å‡ é‡Œå¾—èŒƒæ•°ï¼Œæ˜¯æŒ‡å‘é‡å„å…ƒç´ çš„å¹³æ–¹å’Œå†å¼€æ–¹ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¡¡é‡å‘é‡çš„å¤§å°ã€‚åœ¨äºŒç»´ç©ºé—´ä¸­ï¼Œå‘é‡ ( x , y ) (x, y) (x,y)çš„L2èŒƒæ•°ä¸º x 2 + y 2 \\sqrt{x^2 + y^2} x2+y2 ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼ŒL2èŒƒæ•°å¸¸ç”¨äºæ­£åˆ™åŒ–æŠ€æœ¯ä¸­ï¼Œå¯ä»¥é™åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚

- å¯¹äºä¸é‚£ä¹ˆå¥½åˆ†ç¦»çš„ç°‡ï¼ŒK-meansä¹Ÿé€‚ç”¨  
  ä¾‹å­ï¼šè®¾è®¡å¸ˆåˆ’åˆ†çŸ­è¢–çš„å°ºç æ ‡å‡†SML  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830097.png)

#### 10.1.2 K-meansçš„ä»£ä»·å‡½æ•°ï¼ˆå¤±çœŸå‡½æ•°distortion functionï¼‰

- ä¸€äº›ç¬¦å·

Ciï¼Œè¡¨ç¤ºå½“å‰**è®­ç»ƒæ ·æœ¬Xiæ‰€åœ¨çš„ç°‡**çš„ç´¢å¼•1~kï¼Œæ˜¯æ¯ä¸ªæ ·æœ¬çš„åˆ†ç±»æ ‡è¯†  
uk æ˜¯ç°‡è´¨å¿ƒçš„ä½ç½®  
**å½“k=Ciæ—¶**ï¼Œuciæ˜¯æ ·æœ¬Xi**è¢«åˆ†é…åˆ°çš„ç°‡**ï¼Œè¿™ä¸ª**ç°‡çš„ç°‡è´¨å¿ƒçš„ä½ç½®**  
mæ˜¯æ‰€æœ‰æ ·æœ¬ä¸ªæ•°  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830098.png)  
ç®—æ³•æ¯ä¸€æ­¥ä¼š**æ›´æ–°æ ·æœ¬æ‰€å±ç°‡çš„ç±»åˆ«å³Ciçš„å€¼**ã€  
æˆ–è€…**ç§»åŠ¨ç°‡è´¨å¿ƒçš„ä½ç½®uk**ï¼Œä»¥é™ä½ä»£ä»·å‡½æ•°  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830099.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830100.png)  
ç”¨å¤šä¸ªä¸åŒçš„ç°‡è´¨å¿ƒåˆå§‹å€¼åˆå§‹åŒ–

#### 10.1.3 åˆå§‹åŒ–K-means

K-means èšç±»ç®—æ³•ç¬¬ä¸€æ­¥**æ˜¯ä¸ºç°‡è´¨å¿ƒ Î¼ j \\mu\_j Î¼j Î¼ k \\mu\_k Î¼k é€‰æ‹©éšæœºä½ç½®ä½œä¸ºåˆå§‹å€¼**

å¦‚æœåˆå§‹å€¼é€‰çš„ä¸å¥½ï¼Œä¼šé™·å…¥**å±€éƒ¨æœ€å°å€¼**ï¼Œ**å¤šæ¬¡è¿è¡Œ**K-meansï¼Œè®¡ç®—ä»–ä»¬çš„Jï¼Œé€‰æœ€å°çš„é‚£ä¸ª  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830101.png)

- ç®—æ³• **å¤šæ¬¡éšæœºåˆå§‹åŒ–**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830102.png)

#### 10.1.3 å¦‚ä½•é€‰æ‹©èšç±»çš„ç°‡çš„æ•°é‡K

- è‚˜éƒ¨æ³•åˆ™ elbow method ï¼ˆä¸€èˆ¬ä¸ç”¨ï¼‰  
  è¿è¡Œå…·æœ‰å„ç§Kå€¼çš„k-meansï¼Œç»˜åˆ¶ä»£ä»·å‡½æ•°-Kçš„å‡½æ•°ï¼Œæ‰¾åˆ°è‚˜å…³èŠ‚ä½ç½®ï¼Œä½†æ¯”è¾ƒä¸»è§‚  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830103.png)

- **æ ¹æ®K-meansåœ¨ç¨åæˆ–ä¸‹æ¸¸ä»»åŠ¡ä¸­çš„è¡¨ç°æ¥è¯„ä¼°å…·ä½“çš„Kå€¼åˆä¸åˆé€‚**  
  ä¾‹å­ï¼šçŸ­è¢–å°ºç åˆ’åˆ†  
  ä½ çš„**ä¸šåŠ¡éœ€æ±‚**åˆ°åº•éœ€è¦3ä¸ªå°ºç ï¼Œè¿˜æ˜¯5ä¸ªå°ºç ï¼Ÿ  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830104.png)

### 10.2 å¼‚å¸¸æ£€æµ‹

#### 10.2.1 å¯†åº¦ä¼°è®¡density estimation

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830105.png)  
å¼‚å¸¸æ£€æµ‹ä¸­çš„å¯†åº¦ä¼°è®¡æ˜¯æŒ‡æ ¹æ®å·²çŸ¥æ•°æ®é›†çš„åˆ†å¸ƒæƒ…å†µï¼Œæ¨æµ‹æ–°çš„æ ·æœ¬æ•°æ®åœ¨è¯¥æ•°æ®é›†ä¸­çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¶åˆ©ç”¨è¿™ç§æ¦‚ç‡åˆ†å¸ƒæ¥åˆ¤æ–­æ ·æœ¬æ˜¯å¦å¼‚å¸¸ã€‚

ä¸€ç§å¸¸è§çš„å¯†åº¦ä¼°è®¡æ–¹æ³•æ˜¯åŸºäºé«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGaussian Mixture Model, GMMï¼‰çš„æ–¹æ³•ã€‚å‡è®¾å·²çŸ¥æ•°æ®é›†ç”±å¤šä¸ªé«˜æ–¯åˆ†å¸ƒç»„æˆï¼Œ**æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒå¯¹åº”æ•°æ®é›†ä¸­çš„ä¸€ä¸ªç°‡**ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°æ¥ä¼°è®¡è¿™äº›é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°ï¼Œä»è€Œå¾—åˆ°æ•´ä¸ªæ•°æ®é›†çš„æ¦‚ç‡åˆ†å¸ƒæ¨¡å‹ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªæ–°çš„æ ·æœ¬æ•°æ®ï¼Œå¯ä»¥è®¡ç®—å®ƒåœ¨è¯¥æ¨¡å‹ä¸‹çš„æ¦‚ç‡å¯†åº¦å€¼ï¼Œå¦‚æœè¯¥å€¼è¾ƒå°ï¼Œåˆ™è®¤ä¸ºè¯¥æ ·æœ¬æ˜¯å¼‚å¸¸å€¼ã€‚

#### 10.2.2 é«˜æ–¯æ­£æ€åˆ†å¸ƒGaussian ï¼ˆNormalï¼‰ Distribution

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830106.png)  
è®¡ç®—æ ·æœ¬çš„mu å’Œsigmaï¼Œå¾—åˆ°é«˜æ–¯åˆ†å¸ƒï¼ˆè¿™é‡Œé™¤ä»¥m-1å’Œ é™¤ä»¥méƒ½æ˜¯å¯ä»¥çš„ï¼ï¼‰  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830107.png)  
åˆ©ç”¨3sigmaåŸåˆ™åˆ¤æ–­æ˜¯å¦ä¸ºå¼‚å¸¸å€¼

> åœ¨å®é™…åº”ç”¨ä¸­ï¼Œ3 sigmaåŸåˆ™é€šå¸¸ç”¨äºè´¨é‡æ§åˆ¶å’Œå¼‚å¸¸å€¼æ£€æµ‹ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæŸä¸€æ‰¹æ¬¡çš„ç”Ÿäº§äº§å“ï¼Œ**å¦‚æœå…¶å°ºå¯¸çš„æ ‡å‡†å·®å°äºä¸‰å€**ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¿™æ‰¹äº§å“çš„å°ºå¯¸åŸºæœ¬ä¸Šæ˜¯ç¬¦åˆè¦æ±‚çš„ã€‚è€Œå¦‚æœæœ‰ä¸ªåˆ«äº§å“å°ºå¯¸åç¦»å¹³å‡å€¼è¶…è¿‡ä¸‰å€æ ‡å‡†å·®ï¼Œé‚£ä¹ˆè¿™ä¸ªäº§å“å°±å¯ä»¥è¢«è®¤ä¸ºæ˜¯å¼‚å¸¸å€¼ï¼Œéœ€è¦è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æµ‹å’Œå¤„ç†ã€‚

è¿™é‡Œxæ˜¯å•ä¸ªæ•°å­—ï¼Œå•ä¸€ç‰¹å¾ï¼Œå¯¹åº”çš„å¼‚å¸¸æ£€æµ‹åªæœ‰ä¸€ä¸ªç‰¹å¾ï¼Œä½†å®é™…ä¼šæœ‰å¾ˆå¤šç‰¹å¾

#### 10.2.3 å¼‚å¸¸æ£€æµ‹ç®—æ³•

- å…¬å¼ç¬¦å·

æ¯ä¸€ä¸ªæ ·æœ¬xiéƒ½æœ‰nä¸ªç‰¹å¾ï¼Œxæ˜¯ä¸€ä¸ªç‰¹å¾å‘é‡ï¼Œåœ¨è¿™é‡Œæ¯”å¦‚å‘åŠ¨æœºçš„çƒ­é‡å’ŒæŒ¯åŠ¨ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯å¯†åº¦ä¼°è®¡ï¼Œä¼°è®¡p(x)ã€‚

è¿™ä¸ª **ç‰¹å¾å‘é‡xçš„æ‰€æœ‰ç‰¹å¾çš„æ¦‚ç‡p(x)** æ˜¯p(x1)\*p(x2)â€¦p(xn)ï¼Œä¸ºäº†ç»™x1çš„æ¦‚ç‡å»ºæ¨¡ï¼Œæ¯”å¦‚è¿™ä¸ªä¾‹å­ä¸­çš„ç¬¬ä¸€ä¸ªç‰¹å¾çƒ­é‡ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‚æ•°mu1 ã€ sigma1ï¼ˆæˆ‘ä»¬éœ€è¦ä¼°è®¡æ‰€æœ‰æ ·æœ¬çš„æ‰€æœ‰ç‰¹å¾x1çš„å‡å€¼å’Œæ–¹å·®ï¼‰

> X<sup>(i)</sup> è¡¨ç¤ºçš„æ˜¯ç¬¬å‡ ä¸ªæ ·æœ¬ ï¼ŒX<sup>ï¼ˆi)</sup> <sub>j</sub> è¡¨ç¤ºçš„æ˜¯ç¬¬iä¸ªæ ·æœ¬çš„ç¬¬jä¸ªç‰¹å¾

![åŠ ç²—æ ·å¼](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830108.png)

- ç®—æ³•  
  ![****](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830109.png)  
  é€šè¿‡pxåˆ†å¸ƒæ¥å½¢è±¡åŒ–ç†è§£å¼‚å¸¸æ£€æµ‹  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830110.png)

#### 10.2.4 å¼‚å¸¸æ£€æµ‹çš„ä¸€äº›æŠ€å·§

## æ¨èç³»ç»Ÿ recommender systems

## å¼ºåŒ–å­¦ä¹  reinforcement learning

[pythonä¸­ç§‘å­¦è®¡æ•°æ³•E](https://blog.csdn.net/weixin_36155754/article/details/112874578)

åœ¨æ•°å­¦ä¸­ï¼ŒçŸ©é˜µç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡æ˜¯å¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£å’Œåˆ†æçŸ©é˜µçš„æ€§è´¨å’Œè¡Œä¸ºã€‚å…¶ä¸­ï¼Œç‰¹å¾å€¼æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œè¡¨ç¤ºçŸ©é˜µæ²¿ç€æŸä¸ªæ–¹å‘çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œè€Œç‰¹å¾å‘é‡åˆ™æ˜¯ä¸€ä¸ªéé›¶å‘é‡ï¼Œè¡¨ç¤ºåœ¨è¿™ä¸ªæ–¹å‘ä¸Šçš„å‘é‡ä¸å˜ï¼Œåªæ˜¯è¢«ç¼©æ”¾äº†ã€‚

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯¹æ•°æ®è¿›è¡Œç‰¹å¾æå–å’Œé™ç»´ï¼Œå…¶ä¸­ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸»æˆåˆ†åˆ†æï¼ˆPrincipal Component Analysis, PCAï¼‰ã€‚PCAé€šè¿‡å¯¹æ•°æ®è¿›è¡ŒçŸ©é˜µåˆ†è§£ï¼Œå°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºä¸€ç»„çº¿æ€§æ— å…³çš„ä¸»æˆåˆ†ï¼Œä»¥å®ç°æ•°æ®é™ç»´çš„ç›®çš„ã€‚

åœ¨PCAä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ•°æ®çš„åæ–¹å·®çŸ©é˜µï¼Œå¹¶æ±‚è§£å…¶ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ã€‚å…·ä½“åœ°ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ª m m mç»´æ•°æ®é›† X X Xï¼Œå…¶ä¸­æ¯ä¸ªæ ·æœ¬éƒ½æœ‰ n n nä¸ªç‰¹å¾ï¼Œé‚£ä¹ˆåæ–¹å·®çŸ©é˜µ C C Cçš„ç»´åº¦å°±æ˜¯ n Ã— n n \\times n nÃ—nï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼š

C = 1 m ( X âˆ’ X Ë‰ ) T ( X âˆ’ X Ë‰ ) C = \\frac{1}{m}(X-\\bar{X})^T(X-\\bar{X}) C\=m1(Xâˆ’XË‰)T(Xâˆ’XË‰)

å…¶ä¸­ X Ë‰ \\bar{X} XË‰æ˜¯æ•°æ®çš„å‡å€¼å‘é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªç‰¹å¾çš„å‡å€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹åæ–¹å·®çŸ©é˜µæ±‚è§£ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œå°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºä¸€ç»„æ–°çš„ä¸»æˆåˆ†ã€‚

åœ¨å®é™…è®¡ç®—ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç‰¹å¾å€¼åˆ†è§£æˆ–å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSingular Value Decomposition, SVDï¼‰æ¥æ±‚è§£ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ã€‚ç‰¹å¾å‘é‡ç¼–ç å°±æ˜¯å°†æ•°æ®è½¬åŒ–ä¸ºç‰¹å¾å‘é‡çš„ä¸€ç§æ–¹å¼ï¼Œå…·ä½“æ¥è¯´ï¼Œå¯ä»¥å°†æ•°æ®æŠ•å½±åˆ°ç‰¹å¾å‘é‡æ‰€è¡¨ç¤ºçš„æ–¹å‘ä¸Šï¼Œä»è€Œå¾—åˆ°ä¸€ç»„æ–°çš„ç‰¹å¾å€¼è¡¨ç¤ºã€‚

ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª 2 Ã— 2 2 \\times 2 2Ã—2çš„çŸ©é˜µ A A Aï¼Œå…¶ç‰¹å¾å€¼ä¸º Î» 1 = 3 , Î» 2 = 1 \\lambda\_1=3,\\lambda\_2=1 Î»1\=3,Î»2\=1ï¼Œç‰¹å¾å‘é‡ä¸º v 1 = \[ 1 , 2 \] T , v 2 = \[ 2 , âˆ’ 1 \] T v\_1=\[1,2\]^T,v\_2=\[2,-1\]^T v1\=\[1,2\]T,v2\=\[2,âˆ’1\]Tï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªåˆ—å‘é‡ x = \[ x 1 , x 2 \] T x=\[x\_1,x\_2\]^T x\=\[x1,x2\]TæŠ•å½±åˆ° v 1 v\_1 v1å’Œ v 2 v\_2 v2æ‰€è¡¨ç¤ºçš„æ–¹å‘ä¸Šï¼Œå¾—åˆ°ä¸€ç»„æ–°çš„ç‰¹å¾å€¼è¡¨ç¤ºï¼š

y 1 = x â‹… v 1 = \[ x 1 , x 2 \] T â‹… \[ 1 , 2 \] T = x 1 + 2 x 2 y\_1 = x \\cdot v\_1 = \[x\_1,x\_2\]^T \\cdot \[1,2\]^T = x\_1+2x\_2 y1\=xâ‹…v1\=\[x1,x2\]Tâ‹…\[1,2\]T\=x1+2x2

y 2 = x â‹… v 2 = \[ x 1 , x 2 \] T â‹… \[ 2 , âˆ’ 1 \] T = 2 x 1 âˆ’ x 2 y\_2 = x \\cdot v\_2 = \[x\_1,x\_2\]^T \\cdot \[2,-1\]^T = 2x\_1-x\_2 y2\=xâ‹…v2\=\[x1,x2\]Tâ‹…\[2,âˆ’1\]T\=2x1âˆ’x2

å…¶ä¸­ï¼Œ y 1 y\_1 y1å’Œ y 2 y\_2 y2å°±æ˜¯åŸå§‹æ•°æ®åœ¨ç‰¹å¾å‘é‡ v 1 v\_1 v1å’Œ v 2 v\_2 v2æ‰€è¡¨ç¤º

## numpyè¯­æ³•

- np.c\_ \[ , \]ç”¨äºè¿æ¥ä¸¤ä¸ªçŸ©é˜µ, å¯ä»¥ç”¨æ¥å¯¹æ¯”æ•°æ®å‰å
- reshapeçš„ç”¨æ³•![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830111.png)  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830112.png)

> reshape ç›¸å½“äºæˆªæ–­ç¡¬å‡‘ï¼Œéœ€è¦è½¬ç½®,T

- np.exp() eåº•æ•°
- X\[:,0\]å°±æ˜¯æ‹‰å‡ºçŸ©é˜µçš„ç¬¬1åˆ—ï¼Œ  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830113.png)
- np.zeroså’Œnp.zeros\_like  
  è®¾ç½®ä¸€ä¸ªç”±0ç»„æˆçš„æ•°ç»„ï¼Œåè€…å¯ä»¥ä¼ å…¥ä¸€ä¸ªçŸ©é˜µ
- äºŒç»´ä»¥ä¸ŠçŸ©é˜µä¹˜æ³•np.matmul(A,W) ç”¨ @ä¹Ÿå¯ä»¥  
  å…¶ä¸­A=np.array(\[\[200,17\]\]) æ˜¯2Dæ•°ç»„ ä¹Ÿå°±æ˜¯çŸ©é˜µ è¿™è¾¹ä¸¤ä¸ª\[\[!!  
  **dotä¹Ÿæ˜¯çŸ©é˜µä¹˜æ³•ï¼Œä½†åªèƒ½æ˜¯äºŒç»´çŸ©é˜µ** dotå…¶å®æ˜¯å‘é‡çš„ç‚¹ç§¯å‰ä¹˜è¿ç®—
- çŸ©é˜µè½¬ç½®çš„ä¸‰ç§æ–¹æ³•
  1. äºŒç»´æ•°ç»„.T
  2. é«˜ç»´æ•°ç»„ transpose()ã€ä¸¤è½´å¯¹æ¢swapaxes  
     https://www.jb51.net/article/162035.htm

## Scikit-Learnåº“

```python
LogisticRegression().fit(X, y)  åœ¨è®­ç»ƒæ•°æ®ä¸Šæ‹Ÿåˆè¿™ä¸ªæ¨¡å‹
y_pred = lr_model.predict(X) é¢„æµ‹
lr_model.score(X, y)) è®¡ç®—åœ¨è®­ç»ƒé›†ä¸Šçš„å‡†ç¡®ç‡
```

## TensorFlow

### æ•°æ®è¡¨ç¤º

- åœ¨TensorFlowå†…éƒ¨ä¸­ç”¨çŸ©é˜µè¡¨ç¤ºæ•°æ®  
  Tensor å¼ é‡ å¯ä»¥çœ‹åšè¡¨ç¤ºçŸ©é˜µçš„ä¸€ç§æ–¹å¼  
  \[\[200,17\]\] æ˜¯2Dæ•°ç»„å°±æ˜¯çŸ©é˜µ  
  \[200,17\] æ˜¯1Dæ•°ç»„  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830114.png)

- æŠŠtensor è½¬æ¢æˆnumpyæ•°ç»„  
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830115.png)

## Keras

Tensorflowä¸­å¹¶å‘å¸ƒäº†Tensorflow 2.0ã€‚Kerasæ˜¯ä¸€ä¸ªç”±FranÃ§ois Cholletç‹¬ç«‹å¼€å‘çš„æ¡†æ¶ï¼Œä¸ºTensorflowåˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ã€ä»¥å±‚ä¸ºä¸­å¿ƒçš„æ¥å£ã€‚

- å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ– Normalization

```python
print(f"Temperature Max, Min pre normalization: {np.max(X[:,0]):0.2f}, {np.min(X[:,0]):0.2f}")
print(f"Duration    Max, Min pre normalization: {np.max(X[:,1]):0.2f}, {np.min(X[:,1]):0.2f}")
norm_l = tf.keras.layers.Normalization(axis=-1)# 
norm_l.adapt(X)  # learns mean, variance
Xn = norm_l(X)
print(f"Temperature Max, Min post normalization: {np.max(Xn[:,0]):0.2f}, {np.min(Xn[:,0]):0.2f}")
print(f"Duration    Max, Min post normalization: {np.max(Xn[:,1]):0.2f}, {np.min(Xn[:,1]):0.2f}")
```

- æŸ¥çœ‹ç½‘ç»œçš„æè¿° model.summary()
- æŸ¥çœ‹æŸä¸€å±‚çš„å‚æ•°ï¼ŒæŸ¥çœ‹å‚æ•°å½¢çŠ¶

```python
[layer1, layer2, layer3] = model.layers
W1,b1 = layer1.get_weights()
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä»¥å¼ é‡çš„å½¢å¼è®¿é—®æƒé‡ã€‚

```python
model.layers[2].weights
```

- model.compileè¯­å¥å®šä¹‰äº†ä¸€ä¸ªæŸå¤±å‡½æ•°å¹¶æŒ‡å®šäº†ä¸€ä¸ªç¼–è¯‘ä¼˜åŒ–ã€‚

```python
model.compile(
    loss=tf.keras.losses.BinaryCrossentropy(),
    optimizer=tf.keras.optimizers.Adam(0.001),
)

```

- model.fitè¯­å¥è¿è¡Œæ¢¯åº¦ä¸‹é™ï¼Œå¹¶å°†æƒé‡ä¸æ•°æ®æ‹Ÿåˆã€‚

```python
model.fit(
    X,y,
    epochs=20
)
```

- é¢„æµ‹model.predict  
  é¢„æµ‹çš„è¾“å…¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥å•ä¸ªä¾‹å­è¢«é‡å¡‘ä¸ºäºŒç»´çš„ã€‚

## Pythonå¸¸ç”¨æŠ€å·§

- æ ¼å¼æ‰“å° få­—ç¬¦ä¸²

```python
 print(f"Iteration {i:4}: Cost {float(J_history[-1]):8.2f}   ") #8.2fä»£è¡¨å·¦å¯¹é½8æ ¼,ä¿ç•™å°æ•°ç‚¹åä¸¤ä½ ä¸ºfloatæµ®ç‚¹å‹ 
```

- åŠ è½½æ•°æ®é›†

```python
load_data("data/ex2data1.txt")
```

- åˆ©ç”¨bool ç´¢å¼•åˆ†åˆ«ç”»å›¾(æŠŠ0 1æƒ…å†µçš„æ•°æ®åˆ†ç¦»å¼€ )

```python
X_train = np.array([0., 1, 2, 3, 4, 5], dtype=np.float32).reshape(-1,1)  # 2-D Matrix
Y_train = np.array([0,  0, 0, 1, 1, 1], dtype=np.float32).reshape(-1,1)  # 2-D Matrix

pos = Y_train == 1 #positive->æ³¨æ„ï¼šæœ¬å¤„é‡‡ç”¨çš„æ˜¯boolç´¢å¼•
neg = Y_train == 0 #negeative
X_train[pos]#array([3., 4., 5.], dtype=float32)


fig,ax = plt.subplots(1,1,figsize=(4,3))
ax.scatter(X_train[pos], Y_train[pos], marker='x', s=80, c = 'red', label="y=1")
ax.scatter(X_train[neg], Y_train[neg], marker='o', s=100, label="y=0", facecolors='none', 
              edgecolors=dlc["dlblue"],lw=3)

ax.set_ylim(-0.08,1.1)
ax.set_ylabel('y', fontsize=12)
ax.set_xlabel('x', fontsize=12)
ax.set_title('one variable plot')
ax.legend(fontsize=12)
plt.show()

```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://cnchu-1310638968.cos.ap-nanjing.myqcloud.com/2023_2/pic/202311101830116.png)

- ç±»å‹è½¬æ¢

```python
.astype(int)
```

## è‹±æ–‡ç§¯ç´¯

- with respect to å…³äº
- omit çœç•¥
- make inroad è¿›å†›
- illustrate å±•ç¤º
- Toggle åˆ‡æ¢
- one half 1/2
- formidable-looking çœ‹èµ·æ¥ç›¸å½“å¯æ€•çš„
- property ç‰¹æ€§
- get stucked è¢«å¡ä½
- incorporates åŒ…å«ä½
- summation æ±‚å’Œ cigema
- mintage å¹´ä»½
- to recap å›é¡¾ä¸€ä¸‹
- heuristic å¯å‘å¼çš„
- plateaus é«˜åŸ
- peek to peek å³°é—´å€¼
- Out of the box å¼€ç®±å³ç”¨
- penalize æƒ©ç½š
- mapped against æ˜ å°„
- concatenate è¿æ¥
- scenario å±€é¢
- training example è®­ç»ƒç¤ºä¾‹
- derivative å¯¼æ•° derivation æ¨å¯¼
- 1 over m måˆ†ä¹‹ä¸€
- sum of i equals 1 through m iä»1åˆ°mçš„æ€»å’Œ
- calculus å¾®ç§¯åˆ†
- convergence æ”¶æ•› diverge. å‘æ•£
- local minimum å±€éƒ¨æœ€å°å€¼ global
- convex function å‡¸å‡½æ•°ï¼Œç¢—å‹ï¼Œä¸€ä¸ªå±€éƒ¨æœ€å°å€¼
- intuitive name ç›´è§‚çš„åç§°
- subset å­é›†
- automate ä½¿è‡ªåŠ¨åŒ–
- plotting routines ç»˜å›¾ä¾‹ç¨‹ã€ç¨‹åº
- Convention æƒ¯ä¾‹
- embedded comments åµŒå…¥çš„æ³¨é‡Š
- quiver plot ç®­å¤´å›¾ æŸ¥çœ‹ä¸¤ä¸ªå‚æ•°çš„æ¢¯åº¦çš„æ–¹æ³•
- magnitude å¤§å° å¹…åº¦ è§„æ¨¡
- scaled æ¯”ä¾‹çš„ scale å°ºåº¦ã€ç¼©æ”¾ scale well to é€‚ç”¨äºå¯ç”¨äº
- primarily for ä¸»è¦ç”¨äº
- A versus B A ä¸Bçš„å…³ç³»
- measure of è¡¡é‡
- in line with ç¬¦åˆ ä¸€è‡´
- a contour plot ç­‰é«˜çº¿å›¾
- steady (monotonic) progress ç¨³æ­¥ï¼ˆå•è°ƒï¼‰å‰è¿›
- Zooming in, æ”¾å¤§
- oscillates from positive to negative åœ¨æ­£æ•°å’Œç¬¦æ•°ä¹‹é—´æ‘†åŠ¨
- delve into ç ”è¯»
- subscript sub ä¸‹æ ‡ superscript ä¸Šæ ‡
- parentheses æ‹¬å·
- algebra ä»£æ•° linear algebra çº¿æ€§ä»£æ•°
- dot products ç‚¹ç§¯ the product of ç§¯
- numerical linear algebra library æ•°å€¼çº¿æ€§ä»£æ•°åº“ numpy
- vertorization çŸ¢é‡åŒ–
- square bracket æ–¹æ‹¬å· \[ \]
- period å¥ç‚¹ dot ç‚¹ comma é€—å·
- fairly seamlessly ç›¸å½“å®Œç¾ æ— ç¼çš„
- specify the shape æŒ‡å®šå½¢çŠ¶
- a mainstay of ä¸»è¦å†…å®¹ ï¼Œä¸­æµç ¥æŸ± main stay
- aligning å¯¹é½
- back-end åç«¯çš„
- display precision æ˜¾ç¤ºç²¾åº¦
- notionally åœ¨æ¦‚å¿µä¸Š
- 1-D ä¸€ç»´çš„
- roughly å¤§è‡´çš„
- Going forward å¾€å
- scatter plot æ•£ç‚¹å›¾
- standard deviation æ ‡å‡†å·® deviation åå·®
- normal distribution æ­£æ€åˆ†å¸ƒ
- as a rule of thumb æ ¹æ®ç»éªŒ
- aim for about -1 äº‰å–çº¦ä¸º -1
- flatten out æ‹‰å¹³äº† å˜å¹³äº†
- trade-of æƒè¡¡
- threefold 3 å€
- overshooting è¿‡å¤´äº†
- oscillating æ‘†åŠ¨ éœ‡è¡
- magnitude å¤§å°
- lot åœ°æ®µ ä¸€å°å—åœŸåœ° loft å…¬å¯“
- a quadratic function äºŒæ¬¡å‡½æ•° cubic function ä¸‰æ¬¡å‡½æ•°
- practitioner ä»ä¸šè€…
- all but å‡ ä¹å·®ä¸å¤š
- interchangebly äº’æ¢çš„
- normalize å½’ä¸€åŒ–
- intercept æˆªè·
- coefficient ç³»æ•°
- a close form æ¥è¿‘
- semicolon åˆ†å· ï¼›
- a neuron ä¸€ä¸ªç¥ç»å…ƒ dendrites æ ‘çª axon è½´çª
- activation æ¿€æ´» activations æ¿€æ´»é¡¹ å¯æ•°
- caveat è­¦å‘Š å‘Šè¯«
- vastly å·¨å¤§çš„
- awareness çŸ¥ååº¦
- terminology æœ¯è¯­
- corresponding to åˆ†åˆ«å¯¹åº”
- architecture of the neural network ç¥ç»ç½‘ç»œçš„æ¶æ„
- multilayer perceptron å¤šå±‚æ„ŸçŸ¥å™¨ ï¼ˆæœ‰å¤šå±‚çš„ç¥ç»ç½‘ç»œ ï¼‰
- rewind the video å€’å¸¦è§†é¢‘
- instantiated å®ä¾‹åŒ–
- Sequential é¡ºåºçš„
- the mean and variance of the data set æ•°æ®é›†çš„å‡å€¼å’Œæ–¹å·®
- be accounted for è¢«è®¡ç®—ã€è€ƒè™‘åœ¨å†…
- interpret è§£é‡Š
- replicate å¤åˆ¶
- transpose è½¬ç½®